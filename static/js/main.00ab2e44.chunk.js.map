{"version":3,"sources":["assets/img/logo/Reactale-logo-50h-white-bg.png","redux/reducers/userReducer.js","redux/actionTypes.js","redux/reducers/uiReducer.js","utils/util.js","redux/reducers/wipTaleReducer.js","redux/reducers/rootReducer.js","redux/configStore.js","utils/theme.js","components/layout/header/Header.js","utils/urls.js","redux/actionCreators/createTaleActions.js","components/layout/sidebar/Sidebar.js","redux/actionCreators/userActions.js","components/layout/footer/Footer.js","components/common/cards/InfoCard.js","components/common/cards/ComplexCard.js","components/pages/home/Home.js","components/common/modal/SimpleModal.js","components/pages/createTale/ImportTaleModal.js","utils/constants.js","components/pages/createTale/CreateTaleIntro.js","components/common/storylet/Choice.js","components/common/icons/ReactoIcon.js","components/common/storylet/Storylet.js","components/common/modal/FullScreenEdit.js","components/pages/createTale/CreateTaleBody.js","components/pages/createTale/ExportTaleModal.js","components/pages/createTale/exportFeatureText.js","components/common/misc/Li.js","components/pages/createTale/CreateTaleFinish.js","components/pages/createTale/CreateTale.js","components/pages/talesFlow/controlPanel/ControlPanel.js","components/pages/talesFlow/controlPanel/JoyStick.js","components/pages/talesFlow/FlowST.js","components/pages/talesFlow/FlowConnector.js","components/pages/talesFlow/ModalEditChoice.js","components/pages/talesFlow/flowMaker.js","components/pages/talesFlow/TalesFlow.js","components/pages/myTales/MyLocalTales.js","utils/routes.js","components/pages/read/PreviewTale.js","components/pages/myTales/MyTales.js","components/common/login/LoginModal.js","App.js","index.js","components/layout/header/style.module.css"],"names":["module","exports","initState","firstname","lastname","email","imgUrl","gender","pLang","sLang","country","history","readlist","userReducer","state","action","type","user","payload","isSidebarOpen","isLoginModalOpen","loginActiveTab","uiReducer","tabIndex","isNaN","startsWith","src","part","substring","length","make3Figure","num","toString","createStorylet","st","id","title","text","choices","createChoice","c","next","wipTaleReducer","start","info","name","description","genre","lang","tags","authorEmail","originalAuthor","storyUrl","desiredUrl","idCounter","storylets","storyboard","storyID","Date","getTime","Math","random","replace","newST","wipTale","stID","cID","filter","fieldName","value","sbI","nextStID","isRemoveOnly","newSB","slice","push","selectedCID","fromStID","toStID","fromST","toST","newChoice","indexOf","splice","rootReducer","combineReducers","ui","store","createStore","composeWithDevTools","applyMiddleware","thunk","theme","createMuiTheme","palette","primary","main","red","A700","dark","A900","typography","fontFamily","join","useStyles","makeStyles","menuButton","marginRight","spacing","toolbar","padding","greet","width","fontSize","textAlign","overflow","textOverflow","marginLeft","connect","dispatch","openSidebar","props","classes","className","AppBar","position","Toolbar","IconButton","edge","onClick","color","aria-label","styles","logoContainer","logoImg","alt","root","ext","config","URL_GET_STORY","URL_CREATE_STORYURL","URL_CREATE_TALE","URL_LOGIN","URL_SIGNUP","URL_LOGOUT","URL_ALLTALES","actionCreateChoice","Error","getState","actionUpdateCText","actionSetTaleAsWIP","tale","console","log","list","fullList","listItem","borderBottom","icoInList","minWidth","ico","faIco","navs","url","icon","HomeIcon","AddBoxIcon","BusinessCenterIcon","closeSidebar","openLoginModal","resetWIPTale","doLogout","axios","get","then","res","data","status","alert","catch","err","Drawer","open","onClose","role","onKeyDown","List","map","nav","index","key","to","ListItem","button","ListItemIcon","ListItemText","faSignInAlt","faSignOutAlt","backgroundColor","links","textDecoration","iconLinks","display","Footer","Box","Grid","container","item","xs","md","Typography","variant","gutterBottom","clsx","href","mt","height","flexDirection","maxWidth","margin","borderTop","flexGrow","marginBottom","InfoCard","Card","children","card","media","paddingTop","desc","expand","transform","transition","transitions","create","duration","shortest","expandOpen","avatar","btnLeft","justifyContent","ComplexCard","expandable","handleEdit","handleDelete","handleReadTale","pageID","React","useState","expanded","setExpanded","CardHeader","Avatar","subheader","author","CardMedia","image","CardContent","component","CardActions","disableSpacing","aria-expanded","Home","tales","setTales","useEffect","py","t","sm","lg","xl","modalWrapper","modalBox","background","paper","border","boxShadow","shadows","titleBar","modalBody","closeIco","top","right","boxSizing","cursor","SimpleModal","isOpen","handleClose","Modal","aria-labelledby","aria-describedby","ImportTaleModal","setForEditing","importedTxt","setImportedTxt","encType","accept","size","onChange","e","file","target","files","reader","FileReader","onload","result","readAsText","handleFileSelect","align","my","TextField","label","multiline","rows","fullWidth","Button","JSON","parse","decodeURIComponent","atob","LANGUAGES","GENRES","typingVal","val","oldInfo","updateTaleInfo","InputProps","endAdornment","InputAdornment","FormControl","InputLabel","Select","labelId","g","MenuItem","toUpperCase","l","placeholder","disabled","choiceBox","selectChoice","left","choiceText","idTag","borderRadius","btnPanel","zIndex","verticalAlign","typingChoiceText","updateChoiceText","handleSelection","isSelected","faTrashAlt","Checkbox","checked","inputProps","fontWeight","ReactoIcon","textField","marginTop","box","orange","joiner","borderLeft","choiceContainer","flexWrap","addChoiceBtn","alignSelf","lineHeight","typingStValue","UpdateStField","createAChoice","sbItem","openFSE","px","pb","pt","faEye","faPencilAlt","noValidate","autoComplete","Fab","fullScreen","minHeight","saveStValue","actionUpdateSTAllText","saveChValue","theForm","createRef","preventAutoSize","ref","defaultValue","compText","current","elements","compTitle","fseParam","setFSEParam","isVisible","ExportTaleModal","expTaleContent","textFieldRef","textRef","getElementsByTagName","select","setSelectionRange","document","execCommand","setTimeout","clickToCopy","exportTale","features","saveLocal","saveOnline","Li","cardHeaders","cardContainer","cardInfo","setTaleAsWIP","isLocalEdit","isExpTaleModalVisible","setExpTModalVis","expTale","setExpTale","getWIPTale","saveTaleLocal","rtl","areFieldsValid","allReactales","window","localStorage","getItem","setItem","stringify","localStorageSpace","saveTaleOnline","a","needsRedirection","post","suggestedUrl","allStrings","hasOwnProperty","Container","featureText","content","btoa","encodeURIComponent","filename","element","createElement","setAttribute","style","body","appendChild","click","removeChild","download","_id","_storyUrl","createNewTale","saveAndResetAll","visibleTabIndex","setVisibleTab","pageTitle","setPageTitle","isImportModalOpen","setIsImportModalOpen","match","setIsLocalEdit","setReactaleForEditing","useCallback","params","trim","theTale","mb","startIcon","Paper","square","Tabs","indicatorColor","textColor","event","newValue","centered","Tab","panel","backgroundImage","btnPane","alignItems","A400","fa","autoMagic","toggleJStick","ControlPanel","deleteComponent","paintFlowboard","faMousePointer","faMagic","btn","up","down","JoyStick","moveLeft","moveRight","moveUp","moveDown","cg","knot","fill","strokeWidth","stroke","selectedKnot","selectedEl","rect","selectedST","stid","FlowST","transformStyle","selectedObj","handleMouseDown","handleMouseUp","handleMouseMove","markSelected","stopPropagation","onMouseDown","onMouseUp","onMouseMove","x","y","cx","FLOW_ST_WIDTH","cy","r","FLOW_ST_HEIGHT","substr","connector","cid","selectedConnector","FlowConnector","x1","y1","x2","y2","modelST","modelCon","flex","ModalEditChoice","handleSave","txt","setTxt","createFlowboard","levelsSTMap","isAutoFormatting","level","stxy","maxRecInALevel","Object","values","reduce","maxLength","longestRowWidth","recsInThisLevel","hGap","i","getTransformStyle","setTransformStyle","setStoryletXY","entryStIDs","allStIDs","idx","getEntryStIDs","keys","putStIntoLevels","currentLevel","alreadyFoundStIDs","levelsDecending","sort","reverse","Array","from","Set","createLevelSTMap","fbi","outerContainer","svgContainer","mainSVG","userSelect","joystick","bottom","deleteStorylet","deleteChoice","createNewChoice","fb","setFb","fbC","setFbC","isJStickVis","setJStickVis","draggedStID","setDraggedStID","prevMPos","setPrevMPos","setSelectedObj","editChoiceData","setEditChoiceData","flowBoard","flowConnectors","connectorsObj","ch","fromX","fromY","toX","toY","ftid","createFlowConnectors","markDraggedStID","ev","pageX","pageY","unmarkDraggedStID","moveST","xDisplace","yDisplace","newFBI","newFB","newFBC","ftidParts","split","updateConnectors","moveDraggetST","_","throttle","mouseDiffX","mouseDiffY","moveWithJStick","comName","confirm","MyLocalTales","localTales","setLocalTales","localLocalTales","goToEditTale","deleteTale","routes","path","exact","CreateTale","setTale","rto","createTimeline","TalesFlow","p","loginModal","changeTab","doLogin","u","pswd","actionLogin","doSignup","actionSignup","localUser","setLocalUser","updateLocalUser","App","ThemeProvider","Sidebar","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.00ab2e44.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAP4AAAAyCAYAAAB8vGaeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAMUAAADFABkurQFwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAATdEVYdEF1dGhvcgBTdW1hbiBCYXJpY2tMkL3qAAAKWklEQVR4nO2dbawcVRnHfw+9hdbSF4RCiyhTojFV/GBUYvwkEJtgY4hgvzVqNCBRoyIqUDQhaqJWK6TBKCH6CUMsKIia+MoHEoMCvoQAFUFEvRJKoVJtsYWWvx9m97p3u7P7nJkzZ2bu3V+yye7sedtnz3+eM+c8cwZqQtIlktbWVX4IkjZpMi9I2td7PSHpL5J2S/q1pNslfV3S+yWd7qzzOkedHn48po4PVix7ZwWbLpW0WdINku6RtEfSIeV2fEbSw5J2SfqUpMxZ5m0Vf88kzhuo690Vy7p5wm/x9Lk+33fa52jFNvfZNOOpMBRJlwA3AnfWUX5NLAVO6r0/aUy6o5JuAS43s2fqb9ZYzqiYPwvNIGkp8GHg08ArCpKd3HttBLYA2yXdBVxlZveXa2p0ktuuTRwXu8AB0VvsslvCEmArcL+kDQ23JWnnlfRa4HfA9RSLfhQGnA/cK+lrkmpxOIFMhR+LRSD6Qc4EfiRpWYNteGXF/Jk3oaQ3AfcAb6hQnwFXAHdKOr5COTGoarv1kk6I0pIGiCb8RSb6Pq8n78hNUdVrrZR08qREktYDP2H8JVAIFwDfjlRWWara7jjgVTEa0gRRhL9IRd/nckkrGqq7qtcCn9ffCZwWoa5Btkq6KHKZIaSyXSupLPxFLnrIJ7HekbpSSSuBVRGKyibUczZQl0C/KCl5v5F0HOBanZlAFqGMRqgk/Kno5zhvcpLoxPBYMLnzfo4aJoF7bATeWlPZ4zgViDHHcGaEMhqh9B+6gEX/OPBdYHdAnnNqass4Ygm/sPNKehnwLmc5B4CLySf/dgTUf25A2likOmm2llLCX8CiB/ijmW0ln7j7jjNPE8t6VSen+oxr+xuB5c5ybjWzH5jZg8A1wBFnviZOmils12qChb/ART+HmQn4hjP52p53LMuHyOMDRr2KPG4Kr/XqgHIe6r8xs8PkIycPg3VsYbQN3hzQjrsLylhiZnf10ix0j3+I4v60xMx+HhRIIelS4Fv4Rf8RSQdC6qjADjM7GrnMvzvTGbASeL5kPTKzlwLzeAJoXgIOkretiGzMdxOX+gZ4eujzfme+ufp7J1sNJ5B0zLFxOGzpDT56Dlgz5vt1kpaZ2SFnecmYZAO38EuIHvKJoVTsBGIL/1nyjuj5zamX9Dxe6ynyk9E44Z8o6ZSC8ONTAtoz3Pm9YlghacbMvJcGMfDY7hDwKPCWMWn6a/l/jtGolLiG+iVF33mKPFABqSP4PJ13lvzkNYms4Phqd2vg8ITP42jjSXMW8NyLkVVrSjNMFP5iFX0JUnos8E1QzQL7HOmyguNL3a05drQVculSZX6kDCls12rGDvUXu+h7d6J5J0BDPFwlJK3CF7wzC7zckS4rOJ7qZppkHj8geMcr/E6u5Rf+sYtd9D08oumTahIT/LPS/3SmK+q8IR6/CimH+qfhC96ZxTdPkVVqTUOMFP5U9HN4J7cO4/MOsfCuQ8/im3vICo6n8vjeWIEYeG3nPWlmJdvRKMf8sVPRz+PtznT/6E0EpsLr8asO9VP1gZR9LcR2nrmHrHxTmmOe8KeiB+AMSZeRR61tdea5r2KdF0oqusXzJjMbjicI8fieNevORqCVIMR2njiG9S1cy5+R9IWC7540s2/OCX8q+jnOITyM9KcV69zce43iZxwbSOTpvAKexHcJskLSWjPb60jbdUKE79GCkc+RPFK6RfGZAT5b8N0fgFz4U9FX4nFgV+I6PcPVvWZ2SJJnHR/yIWtM4R8A/uVM27bgnRfJIxG9y4wZ7RL+RGamoq/Eg8B7GhjmebxWf3LKO+mYUf2SZQ4zuzhWWZHx2O5JM3tJUojtOsUMube6NVJ5q5i/BPRvwgI5SpNQfI8B9wJ3AD80sxcS1TtIiPCHY+iLyMo1pXOE2G4/+YrNpL31sioNaoIZM3suYnneoV2XWUu+vvtQE6KXtBpf8M5TAGZ2QNJBJq+VdzIQJYSA4J2+7SRpL5NPFp2zXV07qyxkVgMfAB6Q1MTWUd7JqcHrdY/Xz8Kb0jm8wTuDttvjSJ+Vak2DzEgKuQOrCsb8mz5eJL8UiFO4WerRxhLyDSdeAD6fsF7vOvSw8Cct2WWlWtMtvLZ7uuB9EVl4U5plhrgzuU2xDfhSpLIeBH5FvoXUuUye9Nwm6RYzezRS/ZPwevwF33lLUGa05PH46yQtN7P/lmhTIyyEof42M4sleoBHzOwTZnY+cJ0j/QnAxyPWP4m6Ou8KteRZhzVSdrQ0CaNje+y34VFGVYgt+mFuBz7pSLcZ+GiFei41s5ucaesarkLEtXxJr8G//fefzOxgjHonUGa05DlpQrvW8g+Z2dj7H7os/LpFD/6tt06XZIni9esa6kM+DxBrLf8GYJMz7dvIH89VN3XbrjN0daifQvSQ71fn4XjCdqupgsfji/m7x4R4rSZIdYNTmaG+13adWtLrosdPJXrwCx/gRPLNGevGu1Hk7oE9KkNCTwd50ZmvKqmCr7y2+42kfuCZd0u1Tnn8rgk/pejpxbp7N9us3ZYBwTsGnFWiimGvVXbX4FBqnw3vBe94hZ+VqKJTHr9LQ/2koh/AOwxdUmsrcmLtB19ENvQ5xYQbpDnBrKPeHYWyGsuOTleE35ToQ0gxeor1BJgiNgxFIqby+CmG+nXb7rSKD1VJSheEf3UHRA9p9qer2+MvJ78XoU+Ixx/uSyEPpUxxgqnbdp1ay2+78K82sy833QgnKWL26/ZaMH/IGnLtPXwHW8hzBlJEvKW2XauZAa5MVNdy4NqA9F0SfSpSdd57e+89D5ToMyx0r/D3lXh8WBmmwh9gxsy2p6hI0hr8wl9sorferPPoL/8vjLqHqzC/8/41IN/wzV7rnPmeCKijCqltF0TR/1/2pDiuP0E7h/qLTfSQP334aNFL0sd66VJ7rccC8p3dfyPpZPzCb9vNTVXISua7iOL/fkuJ8pYVldd/tU34i1H0IYR03jU2APAfZ76s/8bM9gB/c+bbIulCSRuBHQHt/G1A2iqEePyzhmzntUEW3qxmaJPwp6IfQ+9SadxTbwc5wrF7HXijCrOhz3c7860i347sYeB9zjyQ7yJcK71h7/qALMMblJa1XWtpi/Cnop9MiLffN+KGIXfnHVrLvzmg3lDuNrOHayy/T0jwzhGOHR15bXdqV9by2yD8qeh9hAxVR22pvd+Zdzlw6sDnXwK/D6jby1HgihrKHUWI7UadNL226++x33qaFv5U9H6CPP6IYyE3EGX9N71Z5cvItxiLyTVmdn/kMosIsd2ok2Yp27WZJoU/FX0YVTuv12vBUOc1s/uA95J76Rh81cy+EqksD0Eef8Sx0rZrK00Jfyr6cKp23kpey8y+B1yAf2OKUTwPXGZmn6lQRhlSevzpUL+Aq6aiL0VKjz+y85rZL4DXAdvJH5Hl5QhwG3C2md0YkC8WVS+TFpzHT3k/voDLzez6hHUuJFIOVws3lTCzZ4ErJV0LvBM4j3xH4g3kS3oryR+sshd4gHxLrV1m5n3efB2kmhiFjmzI8T9Mjtxjnwr6EwAAAABJRU5ErkJggg==\"","import {\r\n    USER_UPDATE,\r\n    USER_RESET\r\n} from '../actionTypes'\r\n\r\nconst initState = {\r\n    firstname: '',\r\n    lastname: '',\r\n    email: '',\r\n    imgUrl: '',\r\n    gender: '',\r\n    pLang: '',\r\n    sLang: '',\r\n    country: '',\r\n    history: '',\r\n    readlist: ''\r\n}\r\n\r\nconst userReducer = (state=initState, action) => {\r\n    switch (action.type) {\r\n\r\n        case USER_UPDATE:\r\n            const { user } = action.payload\r\n            return { ...state, ...user }\r\n\r\n        case USER_RESET: \r\n            return {...initState}\r\n\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default userReducer","// ALL UI MANIPULATION ACTION TYPES\r\nexport const UI_SIDEBAR_OPEN = \"UI_SIDEBAR_OPEN\"\r\nexport const UI_SIDEBAR_CLOSE = \"UI_SIDEBAR_CLOSE\"\r\nexport const UI_LOGIN_MODAL_OPEN = \"UI_LOGIN_MODAL_OPEN\"\r\nexport const UI_LOGIN_MODAL_CLOSE = \"UI_LOGIN_MODAL_CLOSE\"\r\nexport const UI_LOGIN_SET_ACT_TAB = \"UI_LOGIN_SET_ACT_TAB\"\r\n\r\nexport const USER_UPDATE = \"USER_UPDATE\"\r\nexport const USER_RESET = \"USER_RESET\"\r\n\r\nexport const TALE_CREATE = \"TALE_CREATE\"\r\nexport const TALE_SET_AS_WIP = \"TALE_SET_AS_WIP\"    // Set the given tale as WIP tale\r\nexport const TALE_UPDATE_INFO = \"TALE_UPDATE_INFO\"\r\nexport const TALE_STATE_CLEANUP = \"TALE_STATE_CLEANUP\"\r\n\r\nexport const STORYLET_CREATE = \"STORYLET_CREATE\"\r\nexport const STORYLET_UPDATE_FIELD = \"STORYLET_UPDATE_FIELD\"\r\nexport const STORYLET_UPDATE_ALL_TEXT = \"STORYLET_UPDATE_ALL_TEXT\"\r\nexport const STORYLET_DELETE = \"STORYLET_DELETE\"\r\n\r\nexport const STORYBOARD_ADD_SINGLE = \"STORYBOARD_ADD_SINGLE\"\r\nexport const STORYBOARD_INSERT_AT = \"STORYBOARD_INSERT_AT\"\r\nexport const STORYBOARD_SELECT_CHOICE = \"STORYBOARD_SELECT_CHOICE\"\r\n\r\nexport const CHOICE_CREATE = \"CHOICE_CREATE\"\r\nexport const CHOICE_DELETE = \"CHOICE_DELETE\"\r\nexport const CHOICE_UPDATE_TEXT = \"CHOICE_UPDATE_TEXT\"\r\nexport const ADD_CID_TO_STID = \"ADD_CID_TO_STID\"\r\n\r\n","import {\r\n    UI_SIDEBAR_OPEN, \r\n    UI_SIDEBAR_CLOSE,\r\n    UI_LOGIN_MODAL_OPEN,\r\n    UI_LOGIN_MODAL_CLOSE,\r\n    UI_LOGIN_SET_ACT_TAB\r\n} from '../actionTypes'\r\n\r\nconst initState = {\r\n    isSidebarOpen: false,\r\n    isLoginModalOpen: false,\r\n    loginActiveTab: 0\r\n}\r\n\r\nconst uiReducer = (state=initState, action) => {\r\n    switch (action.type) {\r\n\r\n        case UI_SIDEBAR_OPEN:\r\n            return { ...state, isSidebarOpen: true }\r\n        \r\n        case UI_SIDEBAR_CLOSE:\r\n            return { ...state, isSidebarOpen: false }\r\n        \r\n        case UI_LOGIN_MODAL_OPEN:\r\n            return { ...state, isLoginModalOpen: true }\r\n\r\n        case UI_LOGIN_MODAL_CLOSE:\r\n            return { ...state, isLoginModalOpen: false }\r\n        \r\n        case UI_LOGIN_SET_ACT_TAB:\r\n            const {tabIndex} = action.payload\r\n            if (!isNaN(tabIndex) && tabIndex < 3 && tabIndex > -1) {\r\n                return { ...state, loginActiveTab: tabIndex }\r\n            }\r\n            return state\r\n        \r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport default uiReducer","export {\r\n    startsWith,\r\n    make3Figure\r\n}\r\n\r\nfunction startsWith (src, part) {\r\n    return src.substring(0, part.length) === part\r\n}\r\n\r\n/**\r\n * This will make a num a 3 figure String\r\n * So, 9 will become 009\r\n * 54 will become 054\r\n * @param {*} num \r\n */\r\nfunction make3Figure (num) {\r\n    let baseNum = 100\r\n    let auxNum = 1000\r\n    if (num < baseNum) {\r\n        return (auxNum+num).toString().substring(1)\r\n    }\r\n    return num.toString()\r\n}","/**\r\n * This is hold and manage the state of the current WIP Tale\r\n * id: StoryID\r\n * start: Start Storylet ID\r\n */\r\nimport { make3Figure } from '../../utils/util'\r\nimport { \r\n    TALE_CREATE, \r\n    TALE_SET_AS_WIP,\r\n    TALE_UPDATE_INFO,\r\n    TALE_STATE_CLEANUP,\r\n    STORYLET_CREATE,\r\n    STORYLET_DELETE,\r\n    STORYLET_UPDATE_FIELD,\r\n    STORYLET_UPDATE_ALL_TEXT,\r\n    STORYBOARD_ADD_SINGLE,\r\n    STORYBOARD_INSERT_AT,\r\n    STORYBOARD_SELECT_CHOICE,\r\n    CHOICE_CREATE,\r\n    CHOICE_DELETE,\r\n    CHOICE_UPDATE_TEXT,\r\n    ADD_CID_TO_STID\r\n} from '../actionTypes'\r\n\r\nconst START_ST_ID = 'ST000' // BY MY STRICTEST CONVENTION \r\n\r\nconst getInitTaleState = () => ({\r\n    id: null,\r\n    start: null,\r\n    info: {\r\n        name: '',\r\n        description: '',\r\n        genre: 'OTHER',\r\n        lang: 'ENGLISH',\r\n        tags: '',\r\n        authorEmail: '',\r\n        originalAuthor: '',\r\n        storyUrl: '',           // The PKey\r\n        desiredUrl: '',         // For local modification only, until storyUrl is got from Server on 1st Online Save\r\n        imgUrl: ''\r\n    },\r\n    idCounter: 0,\r\n    storylets: {},\r\n    choices: {},\r\n    storyboard: []  // sbI = { stID, selectedCID }  StoryBoardItems[]\r\n})\r\n\r\nconst createStorylet = st => {\r\n    st = st || {}\r\n    return {\r\n        id: st.id,\r\n        title: st.title || '',\r\n        text: st.text || '',\r\n        choices: st.choices || [] // This will hold only Choice IDs\r\n    }\r\n}\r\n\r\nconst createChoice = c => {\r\n    c = c || {}\r\n    return {\r\n        id: c.id,\r\n        text: c.text || '',\r\n        next: c.next || null\r\n    }\r\n}\r\n\r\nconst wipTaleReducer = (state=getInitTaleState(), action) => {\r\n    switch (action.type) {\r\n\r\n        /**\r\n         * Create a new Tale, START Storylet ID will always be \"st0\"\r\n         */\r\n        case TALE_CREATE: {\r\n            const storyID = 'R' + (new Date()).getTime() + Math.random().toString().replace('.','') // required for local-file-naming-collision-avoid etc\r\n            const newST = createStorylet({id: START_ST_ID})\r\n            let wipTale = {\r\n                ...state,\r\n                id: storyID,\r\n                start: START_ST_ID,\r\n                storylets: { \r\n                    [START_ST_ID]: newST\r\n                },\r\n                storyboard: [{stID: START_ST_ID}]\r\n            }\r\n            return wipTale\r\n        }\r\n\r\n        /**\r\n         * To work on an existing Tale, we need to set it as WIP Tale\r\n         */\r\n        case TALE_SET_AS_WIP: {\r\n            return {\r\n                ...action.payload,\r\n                storyboard: [{stID: START_ST_ID}]\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Update the \"info\" object of Tale, while typing in text fields \r\n         */\r\n        case TALE_UPDATE_INFO: {\r\n            return {\r\n                ...state,\r\n                info: action.payload\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Before leaving the Tale creation / edit page, it's good\r\n         * to reset the state\r\n         */\r\n        case TALE_STATE_CLEANUP: {\r\n            return getInitTaleState()\r\n        }\r\n\r\n        /**\r\n         * If already exists a storylet with STID, do nothing\r\n         * Else create one\r\n         */\r\n        case STORYLET_CREATE: {\r\n            const stID = action.payload.stID\r\n            if (state.storylets[stID]) {\r\n                return state\r\n            }\r\n            else {\r\n                const newST = createStorylet({id: stID})\r\n                return {\r\n                    ...state,\r\n                    idCounter: state.idCounter + 1,\r\n                    storylets: {\r\n                        ...state.storylets, \r\n                        [stID]: newST\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Delete the storylet of given stID as payload\r\n         * Delete all its choices\r\n         * Loop thru all storylets and delete all choices pointing to this one\r\n         * \r\n         * So basically, when we delete a storylet, we also delete all \r\n         * incoming and outgoing connectors (choice)\r\n         * i.e. deleting 1 storylet and lots of choices\r\n         */\r\n        case STORYLET_DELETE: {\r\n            let stID = action.payload\r\n            let st = state.storylets[stID]\r\n            let storylets = {...state.storylets}\r\n            let choices = {...state.choices}\r\n            // Delete all outgoing choices\r\n            for(let cID of st.choices) {\r\n                delete choices[cID]\r\n            }\r\n\r\n            // Now loop thru all the storylets, except this one\r\n            // And delete choices which point to this storylet\r\n            for(let id in storylets) {\r\n                if (id === stID) continue\r\n                storylets[id].choices = storylets[id].choices.filter(cID => {\r\n                    let ch = choices[cID]\r\n                    if(ch.next === stID) {\r\n                        delete choices[cID]\r\n                        return false\r\n                    }\r\n                    return true\r\n                })\r\n            }\r\n\r\n            // Finally delete this ST\r\n            delete storylets[stID]\r\n\r\n            let newState = {\r\n                ...state,\r\n                storylets,\r\n                choices\r\n            }\r\n            // console.log(newState)\r\n            return newState\r\n        }\r\n\r\n        /**\r\n         * Update the given storylet field of given STID as typed\r\n         */\r\n        case STORYLET_UPDATE_FIELD: {\r\n            const {stID, fieldName, value} = action.payload\r\n            const newST = {...state.storylets[stID]}\r\n            newST[fieldName] = value\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [stID]: newST\r\n                }\r\n            }\r\n        }\r\n\r\n        case STORYLET_UPDATE_ALL_TEXT: {\r\n            const { stID, title, text } = action.payload\r\n            const newST = {\r\n                ...state.storylets[stID],\r\n                title, text\r\n            }\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [stID]: newST\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * ADD a single Storyboard Item to Storyboard array\r\n         * Each Storyboard Item will be an object with STID, selectedCID (optional) etc\r\n         */\r\n        case STORYBOARD_ADD_SINGLE: {\r\n            return {\r\n                ...state,\r\n                storyboard: [...state.storyboard, {stID: action.payload.stID}]\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Add s SBI to a particular spot of SB\r\n         * If isRemoveOnly=true, that means user has deselected a Choice checkbox \r\n         * but nothing is selected\r\n         */\r\n        case STORYBOARD_INSERT_AT: {\r\n            const {sbI, nextStID, isRemoveOnly} = action.payload\r\n            let newSB = [...state.storyboard]\r\n            newSB = newSB.slice(0, sbI+1)\r\n            if (!isRemoveOnly) {\r\n                newSB.push({stID: nextStID})\r\n            }            \r\n            return {\r\n                ...state,\r\n                storyboard: newSB\r\n            }\r\n        }\r\n        \r\n        /**\r\n         * Select a particular Choice of a Storylet, means for that particular\r\n         * SBI we need to mark the CID as selected\r\n         */\r\n        case STORYBOARD_SELECT_CHOICE: {\r\n            const {sbI, cID} = action.payload\r\n            let newSB = [...state.storyboard]\r\n            newSB[sbI] = {\r\n                ...newSB[sbI],\r\n                selectedCID: cID\r\n            }\r\n            return {\r\n                ...state,\r\n                storyboard: newSB\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Create a new choice with the given data,\r\n         * Parameters in action.payload contains\r\n         * fromStID { mandatory }\r\n         * toStID { optional }\r\n         * text { optional }\r\n         */\r\n        case CHOICE_CREATE: {\r\n            let {fromStID, toStID, text} = action.payload\r\n            let fromST = {...state.storylets[fromStID]}\r\n            let idCounter = state.idCounter\r\n\r\n            // if toStID was not provided, create it\r\n            toStID = toStID || ('S' + make3Figure(++idCounter) )\r\n\r\n            // if toST does not exist create it\r\n            let toST = state.storylets[toStID] ? {...state.storylets[toStID]} : createStorylet({id: toStID})\r\n\r\n            // Now create the Choice\r\n            let cID = 'C' + make3Figure(++idCounter)\r\n            const newChoice = createChoice({id: cID, next: toStID, text})\r\n            fromST.choices = [...fromST.choices, cID]\r\n\r\n            return {\r\n                ...state,\r\n                idCounter: idCounter,\r\n                choices: {\r\n                    ...state.choices,\r\n                    [cID]: newChoice\r\n                },\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [toStID]: toST,\r\n                    [fromStID]: fromST\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Update the given choice text as typed\r\n         */\r\n        case CHOICE_UPDATE_TEXT: {\r\n            const {cID, value} = action.payload\r\n            const newChoice = {...state.choices[cID]}\r\n            newChoice.text = value\r\n            return {\r\n                ...state,\r\n                choices: {\r\n                    ...state.choices,\r\n                    [cID]: newChoice\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * CHOICE_DELETE => delete a choice of given ID\r\n         */\r\n        case CHOICE_DELETE: {\r\n            const cID = action.payload\r\n            let choices = {...state.choices}\r\n            // Go thru all the storylets\r\n            // And delete this cID from whoever has this choice\r\n            // Note: each choice is unique, one to one connector\r\n            // i.e. one choice belongs to 1 storylet only\r\n            // and it points to only 1 storylet with its next\r\n            let st;\r\n            for(let id in state.storylets) {\r\n                if(state.storylets[id].choices.indexOf(cID) > -1) {\r\n                    st = {...state.storylets[id]}\r\n                    break\r\n                }\r\n            }\r\n            // remove this cID from its parent st\r\n            st.choices = [...st.choices]\r\n            st.choices.splice(st.choices.indexOf(cID), 1)\r\n\r\n            // now delete this choice\r\n            delete choices[cID]\r\n\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [st.id]: st\r\n                },\r\n                choices\r\n            }\r\n\r\n        }\r\n        \r\n        /**\r\n         * Add the given choice to the given Storylet's choices array\r\n         */\r\n        case ADD_CID_TO_STID: {\r\n            const {stID, cID} = action.payload\r\n            const newST = {...state.storylets[stID]}\r\n            newST.choices = [...newST.choices, cID]\r\n            return {\r\n                ...state,\r\n                storylets: {\r\n                    ...state.storylets,\r\n                    [stID]: newST\r\n                }\r\n            }\r\n        }\r\n\r\n        default: {\r\n            return state\r\n        }\r\n    }\r\n}\r\n\r\nexport default wipTaleReducer","import { combineReducers } from 'redux'\r\nimport userReducer from './userReducer'\r\nimport uiReducer from './uiReducer'\r\nimport wipTaleReducer from './wipTaleReducer'\r\n\r\nconst rootReducer = combineReducers({\r\n    ui: uiReducer,\r\n    user: userReducer,\r\n    wipTale: wipTaleReducer\r\n})\r\n\r\nexport default rootReducer","import { createStore, applyMiddleware } from 'redux'\r\nimport thunk from 'redux-thunk'\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\nimport rootReducer from './reducers/rootReducer'\r\n\r\nconst store = createStore(rootReducer, composeWithDevTools(\r\n    applyMiddleware(thunk)\r\n))\r\n\r\nexport default store","import { createMuiTheme } from '@material-ui/core/styles';\r\nimport red from '@material-ui/core/colors/red';\r\n\r\n// $themeColor: #d50000; // #d50000 red accent-4 // #e65100 orange darken-4   // #f44336 red;\r\n// $themeColorAlpha: rgba(213, 0, 0, 0.3);          //#e6510080;    // themeColor appended with 80. for .5 alpha\r\n// $themeColorDisabled: #ff9e80; //deep-orange accent-1\r\n// $themeColorLight: #ffcdd2;  // red lighten-4\r\n// $themeColorDark: darkred;\r\n// $themeColorDarker: rgb(113, 0, 0);\r\n// $textLight: #e57373; // red lighten-2\r\n// $iconColor: #ff7043; //deep-orange lighten-1 //#ef5350; // red lighten-1 // used for many things, not only icons\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: red.A700,\r\n      dark: red.A900\r\n    }\r\n  },\r\n  typography: {\r\n    fontFamily: [\r\n      '\"Exo\"',\r\n      'sans-serif'\r\n    ].join(','),\r\n  }\r\n});\r\n\r\nexport default theme","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Button from '@material-ui/core/Button'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport MenuIcon from '@material-ui/icons/Menu'\r\nimport logoImg from '../../../assets/img/logo/Reactale-logo-50h-white-bg.png'\r\nimport styles from './style.module.css'\r\nimport { connect } from 'react-redux'\r\nimport { UI_SIDEBAR_OPEN } from '../../../redux/actionTypes'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  menuButton: {\r\n    marginRight: theme.spacing(2),\r\n  },\r\n  toolbar: {\r\n    padding: '0 10px'\r\n  },\r\n  greet: {\r\n    width: 75,\r\n    fontSize: 14,\r\n    textAlign: 'center',\r\n    overflow: 'hidden',\r\n    textOverflow: 'ellipsis',\r\n    marginLeft: 7\r\n  }\r\n}))\r\n\r\nconst Header = props => {\r\n  const classes = useStyles()\r\n  const { openSidebar, user } = props\r\n  // console.log(styles)\r\n  return (\r\n    <div className=\"flex-grow-1\">\r\n      <AppBar position=\"static\">\r\n        <Toolbar className={classes.toolbar}>\r\n          <IconButton edge=\"start\" onClick={openSidebar} className={classes.menuButton} color=\"inherit\" aria-label=\"menu\">\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <div className={styles.logoContainer}>\r\n            <img src={logoImg} alt=\"Reactale Logo\" className={styles.logoImg} />\r\n          </div>          \r\n          {/* <Button color=\"inherit\" onClick={openLoginModal}>Login</Button> */}\r\n          <div className={classes.greet}>\r\n            {!user.firstname && <span title=\"Welcome Guest\">Welcome Guest!</span>}\r\n            {user.firstname && <span title={'Welcome ' + user.firstname}>Welcome {user.firstname}!</span>}\r\n          </div>\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n  openSidebar: () => dispatch({type: UI_SIDEBAR_OPEN})\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header)\r\n","const env = 'b' // can be a/b/c \r\n\r\nconst root = {\r\n    \"a\": \"\",\r\n    \"b\": \"http://localhost/reactalev2\",\r\n    \"c\": \"/everest\"\r\n}\r\n\r\nconst ext = {\r\n    \"a\": \"\",\r\n    \"b\": \".php\",\r\n    \"c\": \".json\"\r\n}\r\n\r\nexport const config = {\r\n    isApp: true\r\n}\r\n\r\n\r\nexport const GET_APP_VER = `${root[env]}/rtale/api/getappver${ext[env]}`\r\nexport const URL_GET_STORY = `${root[env]}/rtale/api/v2/getstory${ext[env]}`\r\nexport const URL_CREATE_STORYURL = `${root[env]}/rtale/api/v2/createuniqueurl${ext[env]}`\r\nexport const URL_CREATE_TALE = `${root[env]}/rtale/api/v2/createstory${ext[env]}`\r\nexport const URL_LOGIN = `${root[env]}/rtale/api/v2/signin${ext[env]}`\r\nexport const URL_SIGNUP = `${root[env]}/rtale/api/v2/signup${ext[env]}`\r\nexport const URL_LOGOUT = `${root[env]}/rtale/api/v2/signout${ext[env]}`\r\nexport const URL_ALLTALES = `${root[env]}/rtale/api/v2/getallstories${ext[env]}`","import {\r\n    TALE_CREATE,\r\n    TALE_SET_AS_WIP,\r\n    TALE_STATE_CLEANUP,\r\n    STORYLET_UPDATE_ALL_TEXT,\r\n    CHOICE_CREATE,\r\n    CHOICE_UPDATE_TEXT\r\n} from '../actionTypes'\r\n\r\nexport const actionCreateNewTale = () => {\r\n    return (dispatch, getState) => {\r\n        dispatch({type: TALE_CREATE})\r\n    }\r\n}\r\n\r\nexport const actionSaveTaleAndReset = () => {\r\n    return (dispatch, getState) => {\r\n        //TODO: Dispatch a save command\r\n        //Then, reset the wipTale state\r\n        dispatch({type: TALE_STATE_CLEANUP})\r\n    }\r\n}\r\n\r\nexport const actionUpdateSTAllText = (stID, title, text) => {\r\n    return dispatch => dispatch({\r\n        type: STORYLET_UPDATE_ALL_TEXT,\r\n        payload: { stID, title, text }\r\n    })\r\n}\r\n\r\nexport const actionCreateChoice = (fromStID, toStID, text) => {\r\n    if(!fromStID) {\r\n        throw (new Error(\"fromStID is mandatory while creating a new choice\"))\r\n    }\r\n    return (dispatch, getState) => {\r\n        dispatch({\r\n            type: CHOICE_CREATE,\r\n            payload: {fromStID, toStID, text}\r\n        })\r\n    }\r\n}\r\n\r\nexport const actionUpdateCText = (cID, value) => {\r\n    return (dispatch, getState) => {\r\n        dispatch({\r\n            type: CHOICE_UPDATE_TEXT,\r\n            payload: {cID, value}\r\n        })\r\n    }\r\n}\r\n\r\nexport const actionSetTaleAsWIP = tale => {\r\n    return dispatch => {\r\n        tale.idCounter = tale.idCounter || 100\r\n        console.log(tale)\r\n        // SET THE WIP TALE\r\n        dispatch({\r\n            type: TALE_SET_AS_WIP,\r\n            payload: tale\r\n        })\r\n    }\r\n}\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Drawer from '@material-ui/core/Drawer'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport { connect } from 'react-redux'\r\nimport { UI_SIDEBAR_CLOSE, UI_LOGIN_MODAL_OPEN } from '../../../redux/actionTypes'\r\nimport { actionLogout } from '../../../redux/actionCreators/userActions'\r\nimport HomeIcon from '@material-ui/icons/Home';\r\nimport AddBoxIcon from '@material-ui/icons/AddBox';\r\n// import AccountTreeIcon from '@material-ui/icons/AccountTree';\r\nimport BusinessCenterIcon from '@material-ui/icons/BusinessCenter'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faSignInAlt, faSignOutAlt } from '@fortawesome/free-solid-svg-icons'\r\nimport {\r\n    actionSaveTaleAndReset,\r\n} from '../../../redux/actionCreators/createTaleActions'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  list: {\r\n    width: 250,\r\n  },\r\n  fullList: {\r\n    width: 'auto',\r\n  },\r\n  listItem: {\r\n    borderBottom: \"1px solid \" + theme.palette.primary.main\r\n  },\r\n  icoInList: {\r\n    minWidth: 40\r\n  },\r\n  ico: {\r\n    fontSize: 30\r\n  },\r\n  faIco: {\r\n    fontSize: 27,\r\n    color: theme.palette.primary.main\r\n  }\r\n}))\r\n\r\nconst navs = [\r\n  {\r\n    name: \"Home\",\r\n    url: \"/home\",\r\n    icon: HomeIcon\r\n  },\r\n  {\r\n    name: \"Create Tale\",\r\n    url: \"/create-tale\",\r\n    icon: AddBoxIcon\r\n  },\r\n  {\r\n    name: \"My Tales\",\r\n    url: \"/my-tales\",\r\n    icon: BusinessCenterIcon\r\n  }\r\n]\r\n\r\nconst Sidebard = props => {\r\n  const classes = useStyles()\r\n  const { openLoginModal, user, doLogout, resetWIPTale } = props\r\n\r\n  const beforeYouGo = url => {\r\n    if (url === \"/create-tale\") {\r\n      // this is the best place to cleanup the current WIP tale\r\n      resetWIPTale()\r\n    }\r\n  }\r\n\r\n  const sideList = side => (\r\n    <div\r\n      className={classes.list}\r\n      role=\"presentation\"\r\n      onClick={props.closeSidebar}\r\n      onKeyDown={props.closeSidebar}\r\n    >\r\n      <List>\r\n        {navs.map((nav, index) => (\r\n          <Link key={nav.name} to={nav.url} className=\"anchor-default-none\" onClick={() => beforeYouGo(nav.url)} >\r\n            <ListItem button className={classes.listItem}>\r\n              <ListItemIcon className={classes.icoInList}>\r\n                <nav.icon color=\"primary\" className={classes.ico} />\r\n              </ListItemIcon>\r\n              <ListItemText primary={nav.name} />\r\n            </ListItem>\r\n          </Link>\r\n        ))}\r\n        {!user.email && <ListItem button className={classes.listItem} onClick={openLoginModal}>\r\n          <ListItemIcon className={classes.icoInList}>\r\n            {/* <nav.icon color=\"primary\" className={classes.ico} /> */}\r\n            <FontAwesomeIcon icon={faSignInAlt} className={classes.faIco} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Login\" />\r\n        </ListItem>}\r\n\r\n        {user.email && <ListItem button className={classes.listItem} onClick={doLogout}>\r\n          <ListItemIcon className={classes.icoInList}>\r\n            {/* <nav.icon color=\"primary\" className={classes.ico} /> */}\r\n            <FontAwesomeIcon icon={faSignOutAlt} className={classes.faIco} />\r\n          </ListItemIcon>\r\n          <ListItemText primary=\"Logout\" />\r\n        </ListItem>}\r\n\r\n      </List>\r\n\r\n\r\n      {/* <Divider />\r\n      <List>\r\n        {['All mail', 'Trash', 'Spam'].map((text, index) => (\r\n          <ListItem button key={text}>\r\n            <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\r\n            <ListItemText primary={text} />\r\n          </ListItem>\r\n        ))}\r\n      </List> */}\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div>\r\n      <Drawer open={props.isSidebarOpen} onClose={props.closeSidebar}>\r\n        {sideList('left')}\r\n      </Drawer>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  isSidebarOpen: state.ui.isSidebarOpen,\r\n  user: state.user\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  closeSidebar: () => dispatch({ type: UI_SIDEBAR_CLOSE }),\r\n  openLoginModal: () => dispatch({type: UI_LOGIN_MODAL_OPEN}),\r\n  resetWIPTale: () => dispatch(actionSaveTaleAndReset()),\r\n  doLogout: () => dispatch(actionLogout())\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebard)\r\n","import { URL_LOGIN, URL_SIGNUP, URL_LOGOUT } from '../../utils/urls'\r\nimport { USER_UPDATE, USER_RESET, UI_LOGIN_MODAL_CLOSE } from '../actionTypes'\r\nimport axios from 'axios'\r\n\r\nexport const actionLogin = user => {\r\n    const { email, pswd } = user\r\n    return dispatch => {\r\n        axios.post(URL_LOGIN, { email, pswd })\r\n            .then(res => {\r\n                let r = res.data\r\n                if (r.status === 200) {\r\n                    let user = r.data\r\n\r\n                    // update the user in redux store\r\n                    dispatch({\r\n                        type: USER_UPDATE,\r\n                        payload: { user }\r\n                    })\r\n\r\n                    // Close the popup\r\n                    dispatch({ type: UI_LOGIN_MODAL_CLOSE })\r\n\r\n                    alert(\"Sign in successfull...\")\r\n                }\r\n                else {\r\n                    alert('Sign in failed...')\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n                alert('Sign in failed...')\r\n            })\r\n    }\r\n}\r\n\r\nexport const actionSignup = user => {\r\n    const { email, pswd, firstname, lastname } = user\r\n    return dispatch => {\r\n        axios.post(URL_SIGNUP, { email, pswd, firstname, lastname })\r\n            .then(res => {\r\n                let r = res.data\r\n                if (r.status === 200 || r.status === 1152) {\r\n                    let user = r.data\r\n\r\n                    //Update user in redux\r\n                    dispatch({\r\n                        type: USER_UPDATE,\r\n                        payload: { user }\r\n                    })\r\n\r\n                    // Close the popup\r\n                    dispatch({ type: UI_LOGIN_MODAL_CLOSE })\r\n\r\n                    alert(\"Sign up successfull...\")\r\n                }\r\n                else {\r\n                    alert('Sign up failed...')\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n                alert('Sign up failed...')\r\n            })\r\n    }\r\n}\r\n\r\nexport const actionLogout = user => {\r\n    return dispatch => {\r\n        axios.get(URL_LOGOUT)\r\n            .then(res => {\r\n                let r = res.data\r\n                if (r.status === 200) {\r\n                    dispatch({\r\n                        type: USER_RESET\r\n                    })\r\n\r\n                    alert(\"Succesfully signed out...\")\r\n                }\r\n                else {\r\n                    alert('Log out failed...')\r\n                }\r\n            })\r\n            .catch(err => {\r\n                console.log(err)\r\n                alert('Log out failed...')\r\n            })\r\n    }\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Box from '@material-ui/core/Box';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport FacebookIcon from '@material-ui/icons/Facebook';\r\nimport TwitterIcon from '@material-ui/icons/Twitter';\r\nimport EmailIcon from '@material-ui/icons/Email';\r\nimport AndroidIcon from '@material-ui/icons/Android';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        backgroundColor: theme.palette.primary.dark,\r\n        color: '#fff',\r\n        padding: `${theme.spacing(5)}px ${theme.spacing(4)}px`\r\n    },\r\n    links: {\r\n        '& a': {\r\n            textDecoration: 'none',\r\n            color: '#fff !important'\r\n        }\r\n    },\r\n    iconLinks: {\r\n        display: 'flex',\r\n        '& svg': {\r\n            fontSize: 27,\r\n            marginRight: theme.spacing(1)\r\n        }\r\n    }\r\n}))\r\n\r\nconst Footer = props => {\r\n    const classes = useStyles()\r\n    return (\r\n        <Box className={classes.root}>\r\n            <Grid container spacing={3}>\r\n                <Grid item xs={12} md={8}>\r\n                    <p className=\"margin-top-0\">\r\n                        Reactale is what happens when literature embraces technology and comes to life. When a reader reads a Reactale (a.k.a Reactive Tale), the Reactale also reads back its reader and then reacts by magically altering itself depending on the reader's actions / decisions / sorroundings and other learnings that are made available to it about its reader.\r\n                    </p>\r\n                    <p>\r\n                        REACTALE marks the birth of a NEW ERA of story telling, in search of a new way, a very REACTIVE one, where no longer will an immersive tale ONLY ENGAGE its readers, but it will INTERACT, and most importantly, it will REACT...\r\n                    </p>\r\n                </Grid>\r\n                <Grid item xs={12} md={4}>\r\n                    <Box>\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            Connect\r\n                        </Typography>\r\n                        <ul className={clsx(classes.links, classes.iconLinks)}>\r\n                            <li><a href=\"https://www.facebook.com/reactale\"><FacebookIcon /></a></li>\r\n                            <li><a href=\"https://twitter.com/ReactiveTales\"><TwitterIcon /></a></li>\r\n                            <li><a href=\"mailto:reactale@gmail.com\"><EmailIcon /></a></li>\r\n                            <li title=\"Android app coming soon\"><a><AndroidIcon /></a></li>\r\n                        </ul>\r\n                    </Box>\r\n                    <Box mt={2}>\r\n                        <Typography variant=\"h5\" gutterBottom>\r\n                            Links\r\n                        </Typography>\r\n                        <ul className={classes.links}>\r\n                            <li>\r\n                                <a href=\"https://reacto.reactale.com/\">Reacto</a>\r\n                            </li>\r\n                            <li>\r\n                                <a href=\"https://reactale.com/rtale/privacy-policy\">Privacy Policy</a>\r\n                            </li>\r\n                            <li>\r\n                                <a href=\"https://reactale.com/rtale/terms-and-conditions\">Terms and Conditions</a>\r\n                            </li>\r\n                        </ul>\r\n                    </Box>\r\n                </Grid>\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default Footer","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Card from '@material-ui/core/Card'\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Button from '@material-ui/core/Button';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    padding: '8px 16px',\r\n    height: '100%',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    maxWidth: 300,\r\n    margin: '10px auto',\r\n    borderTop: `5px solid ${theme.palette.primary.main}`,\r\n    borderTop: `5px solid ${theme.palette.primary.main}`,\r\n    '& .fillmid': {\r\n        flexGrow: 1,\r\n        marginBottom: 10\r\n    }\r\n  }\r\n}));\r\n\r\nconst InfoCard = props => {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n        {props.children}\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default InfoCard\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardMedia from '@material-ui/core/CardMedia';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CardActions from '@material-ui/core/CardActions';\r\n// import Collapse from '@material-ui/core/Collapse';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { red } from '@material-ui/core/colors';\r\nimport FavoriteIcon from '@material-ui/icons/Favorite';\r\nimport ShareIcon from '@material-ui/icons/Share';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  card: {\r\n    maxWidth: 345,\r\n    margin: \"0 auto\"\r\n  },\r\n  media: {\r\n    height: 0,\r\n    paddingTop: '56.25%', // 16:9\r\n  },\r\n  desc: {\r\n    height: 95,\r\n    overflow: 'hidden'\r\n  },\r\n  expand: {\r\n    transform: 'rotate(0deg)',\r\n    marginLeft: 'auto',\r\n    transition: theme.transitions.create('transform', {\r\n      duration: theme.transitions.duration.shortest,\r\n    }),\r\n  },\r\n  expandOpen: {\r\n    transform: 'rotate(180deg)',\r\n  },\r\n  avatar: {\r\n    backgroundColor: red[500],\r\n  },\r\n  btnLeft: {\r\n    justifyContent: 'flex-start',\r\n    flexGrow: 1,\r\n    '& svg': {\r\n      color: theme.palette.primary.dark\r\n    }\r\n  }\r\n}));\r\n\r\nconst ComplexCard = props => {\r\n  const classes = useStyles()\r\n  const {id, info, expandable, handleEdit, handleDelete, handleReadTale, pageID} = props\r\n  const [expanded, setExpanded] = React.useState(false);\r\n\r\n  const handleExpandClick = () => {\r\n    setExpanded(!expanded);\r\n  };\r\n\r\n  return (\r\n    <Card className={classes.card}>\r\n      <CardHeader\r\n        avatar={\r\n          <Avatar aria-label=\"recipe\" className={classes.avatar}>\r\n            S\r\n          </Avatar>\r\n        }\r\n        action={\r\n          <IconButton aria-label=\"settings\">\r\n            <MoreVertIcon />\r\n          </IconButton>\r\n        }\r\n        title={info.name}\r\n        subheader={\r\n          <span>\r\n            <span>\r\n              {info.genre}\r\n            </span>\r\n            {\r\n              info.author && <span>{' | ' + info.author}</span>\r\n            }\r\n          </span>\r\n        }\r\n      />\r\n      <CardMedia\r\n        className={classes.media}\r\n        onClick={handleReadTale}\r\n        image={info.imgUrl || \"/static/img/bg/small/storytelling-4203628_640.jpg\"}\r\n        title=\"Story Image\"\r\n      />\r\n      <CardContent>\r\n        <Typography variant=\"body2\" className={classes.desc} color=\"textSecondary\" component=\"p\">\r\n          {info.description}\r\n        </Typography>\r\n      </CardContent>\r\n      <CardActions disableSpacing>\r\n        <div className={classes.btnLeft}>\r\n          {pageID !== 'HOME' &&\r\n          <IconButton \r\n            aria-label=\"delete\"\r\n            onClick={() => handleDelete(id)}\r\n          >\r\n            <DeleteIcon />\r\n          </IconButton>}\r\n        </div>\r\n        <IconButton aria-label=\"add to favorites\">\r\n          <FavoriteIcon />\r\n        </IconButton>\r\n        <IconButton aria-label=\"share\">\r\n          <ShareIcon />\r\n        </IconButton>\r\n        {pageID !== 'HOME' &&\r\n         <IconButton aria-label=\"edit\" onClick={() => handleEdit(id)} >\r\n          <EditIcon />\r\n        </IconButton>}\r\n\r\n        {expandable && \r\n            <IconButton\r\n                className={clsx(classes.expand, {\r\n                    [classes.expandOpen]: expanded,\r\n                })}\r\n                onClick={handleExpandClick}\r\n                aria-expanded={expanded}\r\n                aria-label=\"show more\"\r\n            >\r\n                <ExpandMoreIcon />\r\n            </IconButton>\r\n        }\r\n      </CardActions>\r\n      {/* <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n        <CardContent>\r\n          <Typography paragraph>Method:</Typography>\r\n          <Typography paragraph>\r\n            Heat 1/2 cup of the broth in a pot until simmering, add saffron and set aside for 10\r\n            minutes.\r\n          </Typography>\r\n          <Typography paragraph>\r\n            Heat oil in a (14- to 16-inch) paella pan or a large, deep skillet over medium-high\r\n            heat. Add chicken, shrimp and chorizo, and cook, stirring occasionally until lightly\r\n            browned, 6 to 8 minutes. Transfer shrimp to a large plate and set aside, leaving chicken\r\n            and chorizo in the pan. Add pimentn, bay leaves, garlic, tomatoes, onion, salt and\r\n            pepper, and cook, stirring often until thickened and fragrant, about 10 minutes. Add\r\n            saffron broth and remaining 4 1/2 cups chicken broth; bring to a boil.\r\n          </Typography>\r\n          <Typography paragraph>\r\n            Add rice and stir very gently to distribute. Top with artichokes and peppers, and cook\r\n            without stirring, until most of the liquid is absorbed, 15 to 18 minutes. Reduce heat to\r\n            medium-low, add reserved shrimp and mussels, tucking them down into the rice, and cook\r\n            again without stirring, until mussels have opened and rice is just tender, 5 to 7\r\n            minutes more. (Discard any mussels that dont open.)\r\n          </Typography>\r\n          <Typography>\r\n            Set aside off of the heat to let rest for 10 minutes, and then serve.\r\n          </Typography>\r\n        </CardContent>\r\n      </Collapse> */}\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default ComplexCard\r\n","import React, { useEffect, useState } from 'react'\r\nimport { URL_ALLTALES } from '../../../utils/urls'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Box from '@material-ui/core/Box'\r\nimport axios from 'axios'\r\nimport { ComplexCard } from '../../common/cards'\r\nimport { config } from '../../../utils/urls'\r\n\r\nconst Home = props => {\r\n    const [tales, setTales] = useState([])\r\n    const { history } = props\r\n    useEffect(() => {\r\n        axios.get(URL_ALLTALES)\r\n        .then(res => {\r\n            console.log(res.data)\r\n            setTales(res.data.tales)\r\n        })\r\n    }, [])\r\n\r\n    const goToTale = storyUrl => {\r\n        // if it an App, go to preview url i.e. SPA way\r\n        if(config.isApp) {\r\n            history.push(`/preview/${storyUrl}`)\r\n        }\r\n        // else go to Real PHP View\r\n        else {\r\n\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Box py={5}>\r\n            {\r\n                tales.length === 0 &&\r\n                <h2 className=\"margin-top-25\">\r\n                    Oops! looks like an issue. We could not fetch any tales at the moment. :(\r\n                </h2>\r\n            }\r\n            <Grid container spacing={2}>\r\n            {\r\n                tales.length > 0 && tales.map (t => \r\n                    <Grid item xs={12} sm={6} md={4} lg={3} xl={2} key={t.storyUrl}>\r\n                        <ComplexCard \r\n                            id={t.storyUrl}\r\n                            info={t} \r\n                            expandable={false} \r\n                            pageID='HOME'\r\n                            handleReadTale={() => goToTale(t.storyUrl)}\r\n                            // handleEdit={goToEditTale}\r\n                            // handleDelete={deleteTale}  \r\n                        />\r\n                    </Grid>\r\n                )\r\n            }\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default Home","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport clsx from 'clsx'\r\nimport CancelIcon from '@material-ui/icons/Cancel'\r\nimport Modal from '@material-ui/core/Modal'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  modalWrapper: {\r\n    overflow: \"auto\"\r\n  },\r\n  modalBox: {\r\n    position: 'relative',\r\n    width: 'calc(100vw - 200px)',\r\n    margin: 'calc(100vh / 5) auto',\r\n    minWidth: 300,\r\n    backgroundColor: theme.palette.background.paper,\r\n    border: `5px double ${theme.palette.primary.main}`,\r\n    boxShadow: theme.shadows[5]\r\n  },\r\n  titleBar: {\r\n    margin: 0,\r\n    backgroundColor: theme.palette.primary.main,\r\n    color: '#fff',\r\n    padding: `${theme.spacing(.5)}px ${theme.spacing(1)}px`\r\n  },\r\n  modalBody: {\r\n    padding: `${theme.spacing(2)}px ${theme.spacing(1)}px`\r\n  },\r\n  closeIco: {\r\n    position: \"absolute\",\r\n    top: 0,\r\n    right: 0,\r\n    boxSizing: 'content-box',\r\n    padding: '5px 7px',\r\n    color: '#fff',\r\n    cursor: 'pointer'\r\n  }\r\n}))\r\n\r\n// const getDynamicStyle = () => ({\r\n//   width: `${window.innerWidth - 200}px`,\r\n//   margin: `${window.innerHeight / 5}px auto`\r\n// })\r\n\r\nconst SimpleModal = props => {\r\n  const classes = useStyles();\r\n  const { isOpen, handleClose, title, children, className } = props\r\n  \r\n  return (\r\n      <Modal\r\n        aria-labelledby={title}\r\n        aria-describedby={title}\r\n        className={classes.modalWrapper}\r\n        open={!!isOpen}\r\n        onClose={handleClose}\r\n      >\r\n        <div className={clsx(classes.modalBox, className)}>\r\n          <CancelIcon className={classes.closeIco} onClick={handleClose}/>\r\n          <h2 className={classes.titleBar}>{title}</h2>\r\n          <div className={classes.modalBody}>\r\n            {children}\r\n          </div>\r\n        </div>\r\n      </Modal>\r\n  );\r\n}\r\n\r\nexport default SimpleModal\r\n","import React, { useState } from 'react'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nimport Typography from '@material-ui/core/Typography';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Box from '@material-ui/core/Box';\r\nimport Button from '@material-ui/core/Button';\r\n\r\nconst ImportTaleModal = props => {\r\n    const {isOpen, handleClose, setForEditing} = props\r\n    const [importedTxt, setImportedTxt] = useState('')\r\n    const importTale = () => {\r\n        const tale = JSON.parse(decodeURIComponent(atob(importedTxt)))\r\n        setForEditing(tale)\r\n        setImportedTxt('')\r\n    }\r\n\r\n    const handleFileSelect = e => {\r\n        let file = e.target.files[0]\r\n        console.log(file)\r\n\r\n        let reader = new FileReader();\r\n\r\n        // Closure to capture the file information.\r\n        reader.onload = (function(theFile) {\r\n            return e => setImportedTxt(e.target.result)\r\n        })(file);\r\n\r\n        // Read in the image file as a data URL.\r\n        reader.readAsText(file);\r\n    }\r\n\r\n    return (\r\n        <SimpleModal \r\n            isOpen={isOpen} \r\n            handleClose = {handleClose}\r\n            title=\"Import Reactale\"\r\n        >\r\n            <Typography variant=\"body1\" gutterBottom>\r\n                Import a previously exported Reactale file <b>OR</b> optionally you can paste the text from it if \"file import\" is not working in your browser\r\n            </Typography>\r\n\r\n            <Box mt={2}>\r\n                <form encType=\"multipart/form-data\">\r\n                    <input \r\n                        type=\"file\" \r\n                        accept=\"text/txt\" \r\n                        name=\"files[]\" \r\n                        size=\"30\" \r\n                        onChange={e => handleFileSelect(e)}\r\n                    />\r\n                </form>\r\n            </Box>\r\n\r\n            <Box align=\"center\" my={1}>\r\n                <Typography variant=\"h6\" gutterBottom>\r\n                    <b>OR</b>\r\n                </Typography>\r\n            </Box>\r\n\r\n            <Box>\r\n                <TextField\r\n                    label=\"Paste Content Here\"\r\n                    multiline\r\n                    rows=\"4\"\r\n                    fullWidth\r\n                    variant=\"outlined\"\r\n                    value = {importedTxt}\r\n                    onChange = { e => setImportedTxt(e.target.value)}\r\n                />\r\n            </Box>\r\n            \r\n            <Box mt={2} align=\"right\">\r\n                <Button \r\n                    size=\"small\"\r\n                    variant=\"contained\" \r\n                    color=\"primary\"\r\n                    onClick={importTale}\r\n                >\r\n                    Import\r\n                </Button>\r\n            </Box>\r\n\r\n            \r\n            \r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ImportTaleModal","export const FLOW_ST_WIDTH = 150\r\nexport const FLOW_ST_HEIGHT = 50\r\nexport const FLOW_KNOW_RAD = 6\r\nexport const FLOW_KNOT_IN_X = FLOW_ST_WIDTH / 2\r\nexport const FLOW_KNOT_IN_Y = -(FLOW_KNOW_RAD/2)\r\nexport const FLOW_KNOT_OUT_X = FLOW_ST_WIDTH / 2\r\nexport const FLOW_KNOT_OUT_Y = FLOW_ST_HEIGHT + (FLOW_KNOW_RAD/2)\r\nexport const FLOW_WIRE_SHIFT_X = FLOW_ST_WIDTH / 2\r\nexport const FLOW_WIRE_SHIFT_FROM_Y = FLOW_ST_HEIGHT + (FLOW_KNOW_RAD/2)\r\nexport const FLOW_WIRE_SHIFT_TO_Y = -(FLOW_KNOW_RAD/2)\r\nexport const FLOW_H_GAP = 50    // Gap between 2 ST\r\nexport const FLOW_V_GAP = 80    // Gap between 2 ST\r\nexport const FLOW_H_SHIFT = 20  // to move the entire setup by a constant amount without breaking anything\r\nexport const FLOW_V_SHIFT = 30  // to move the entire setup by a constant amount without breaking anything\r\nexport const FLOW_SPEED = 10\r\nexport const LOCAL_TALE_IDENTIFIER = \"__local__\"\r\n\r\n\r\nexport const COUNTRIES = [\"Afghanistan\",\"Albania\",\"Algeria\",\"Andorra\",\"Angola\",\"Antigua and Barbuda\",\"Argentina\",\"Armenia\",\"Australia\",\"Austria\",\"Azerbaijan\",\"Bahamas\",\"Bahrain\",\"Bangladesh\",\"Barbados\",\"Belarus\",\"Belgium\",\"Belize\",\"Benin\",\"Bhutan\",\"Bolivia\",\"Bosnia and Herzegovina\",\"Botswana\",\"Brazil\",\"Brunei\",\"Bulgaria\",\"Burkina Faso\",\"Burundi\",\"Cabo Verde\",\"Cambodia\",\"Cameroon\",\"Canada\",\"Central African Republic (CAR)\",\"Chad\",\"Chile\",\"China\",\"Colombia\",\"Comoros\",\"Congo, Democratic Republic of the\",\"Congo, Republic of the\",\"Costa Rica\",\"Cote d'Ivoire\",\"Croatia\",\"Cuba\",\"Cyprus\",\"Czechia\",\"Denmark\",\"Djibouti\",\"Dominica\",\"Dominican Republic\",\"Ecuador\",\"Egypt\",\"El Salvador\",\"Equatorial Guinea\",\"Eritrea\",\"Estonia\",\"Eswatini (formerly Swaziland)\",\"Ethiopia\",\"Fiji\",\"Finland\",\"France\",\"Gabon\",\"Gambia\",\"Georgia\",\"Germany\",\"Ghana\",\"Greece\",\"Grenada\",\"Guatemala\",\"Guinea\",\"Guinea-Bissau\",\"Guyana\",\"Haiti\",\"Honduras\",\"Hungary\",\"Iceland\",\"India\",\"Indonesia\",\"Iran\",\"Iraq\",\"Ireland\",\"Israel\",\"Italy\",\"Jamaica\",\"Japan\",\"Jordan\",\"Kazakhstan\",\"Kenya\",\"Kiribati\",\"Kosovo\",\"Kuwait\",\"Kyrgyzstan\",\"Laos\",\"Latvia\",\"Lebanon\",\"Lesotho\",\"Liberia\",\"Libya\",\"Liechtenstein\",\"Lithuania\",\"Luxembourg\",\"Madagascar\",\"Malawi\",\"Malaysia\",\"Maldives\",\"Mali\",\"Malta\",\"Marshall Islands\",\"Mauritania\",\"Mauritius\",\"Mexico\",\"Micronesia\",\"Moldova\",\"Monaco\",\"Mongolia\",\"Montenegro\",\"Morocco\",\"Mozambique\",\"Myanmar (formerly Burma)\",\"Namibia\",\"Nauru\",\"Nepal\",\"Netherlands\",\"New Zealand\",\"Nicaragua\",\"Niger\",\"Nigeria\",\"North Korea\",\"North Macedonia (formerly Macedonia)\",\"Norway\",\"Oman\",\"Pakistan\",\"Palau\",\"Palestine\",\"Panama\",\"Papua New Guinea\",\"Paraguay\",\"Peru\",\"Philippines\",\"Poland\",\"Portugal\",\"Qatar\",\"Romania\",\"Russia\",\"Rwanda\",\"Saint Kitts and Nevis\",\"Saint Lucia\",\"Saint Vincent and the Grenadines\",\"Samoa\",\"San Marino\",\"Sao Tome and Principe\",\"Saudi Arabia\",\"Senegal\",\"Serbia\",\"Seychelles\",\"Sierra Leone\",\"Singapore\",\"Slovakia\",\"Slovenia\",\"Solomon Islands\",\"Somalia\",\"South Africa\",\"South Korea\",\"South Sudan\",\"Spain\",\"Sri Lanka\",\"Sudan\",\"Suriname\",\"Sweden\",\"Switzerland\",\"Syria\",\"Taiwan\",\"Tajikistan\",\"Tanzania\",\"Thailand\",\"Timor-Leste\",\"Togo\",\"Tonga\",\"Trinidad and Tobago\",\"Tunisia\",\"Turkey\",\"Turkmenistan\",\"Tuvalu\",\"Uganda\",\"Ukraine\",\"United Arab Emirates (UAE)\",\"United Kingdom (UK)\",\"United States of America (USA)\",\"Uruguay\",\"Uzbekistan\",\"Vanuatu\",\"Vatican City (Holy See)\",\"Venezuela\",\"Vietnam\",\"Yemen\",\"Zambia\",\"Zimbabwe\"]\r\nexport const LANGUAGES = [\"Algerian Arabic\", \"Amharic\", \"Assamese\", \"Bengali\", \"Bhojpuri\", \"Burmese\", \"Cebuano\", \"Chhattisgarhi\", \"Chittagonian\", \"Czech\", \"Deccan\", \"Dutch\", \"Eastern Punjabi\", \"Egyptian Arabic\", \"English\", \"French\", \"Gan\", \"German\", \"Greek\", \"Gujarati\", \"Hakka\", \"Hausa\", \"Hejazi Arabic\", \"Hindi\", \"Hungarian\", \"Igbo\", \"Indonesian\", \"Iranian Persian\", \"Italian\", \"Japanese\", \"Javanese\", \"Jinyu\", \"Kannada\", \"Kazakh\", \"Khmer\", \"Kinyarwanda\", \"Korean\", \"Magahi\", \"Maithili\", \"Malay\", \"Malayalam\", \"Mandarin\", \"Marathi\", \"Mesopotamian Arabic\", \"Min Bei Chinese\", \"Min Dong Chinese\", \"Min Nan\", \"Moroccan Arabic\", \"Nepali\", \"Nigerian Fulfulde\", \"North Levantine Arabic\", \"Northern Kurdish\", \"Northern Pashto\", \"Northern Uzbek\", \"Odia\", \"Polish\", \"Portuguese\", \"Romanian\", \"Rundi\", \"Russian\", \"Sanaani Spoken Arabic\", \"Saraiki\", \"Saidi Arabic\", \"Sindhi\", \"Sinhala\", \"Somali\", \"South Azerbaijani\", \"South Levantine Arabic\", \"Southern Pashto\", \"Spanish\", \"Sudanese Arabic\", \"Sunda\", \"Sylheti\", \"Tagalog\", \"Tamil\", \"Taizzi-Adeni Arabic\", \"Telugu\", \"Thai\", \"Tunisian Arabic\", \"Turkish\", \"Ukrainian\", \"Urdu\", \"Uyghur\", \"Vietnamese\", \"Western Punjabi\", \"Wu\", \"Xiang Chinese\", \"Yoruba\", \"Yue\", \"Zulu\", \"Other\"]\r\nexport const GENRES = [\"Absurdist\", \"Action\", \"Adventure\", \"Comedy\", \"Crime\", \"Drama\", \"Fantasy\", \"Historical\", \"Historical fiction\", \"Horror\", \"Magical realism\", \"Mystery\", \"Paranoid fiction\", \"Philosophical\", \"Political\", \"Romance\", \"Saga\", \"Satire\", \"Science fiction\", \"Social\", \"Speculative\", \"Surreal\", \"Thriller\", \"Urban\", \"Western\", \"Whimsical\", \"Other\"]\r\n\r\n","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n// import Paper from '@material-ui/core/Paper'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline'\r\nimport Box from '@material-ui/core/Box'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Select from '@material-ui/core/Select'\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport InfoIcon from '@material-ui/icons/Info'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    TALE_UPDATE_INFO\r\n} from '../../../redux/actionTypes'\r\nimport { \r\n    COUNTRIES,\r\n    LANGUAGES,\r\n    GENRES \r\n} from '../../../utils/constants'\r\n// const useStyles = makeStyles(theme => ({\r\n//     root: {\r\n//     }\r\n// }))\r\n\r\nconst updateTaleInfo = (dispatch, key, val, oldInfo) => {\r\n    dispatch({\r\n        type: TALE_UPDATE_INFO,\r\n        payload: {\r\n            ...oldInfo,\r\n            [key]: val\r\n        }\r\n    })\r\n}\r\n\r\nconst CreateTaleIntro = props => {\r\n    // const classes = useStyles()\r\n    const { info, typingVal, user } = props\r\n\r\n    return (\r\n        <Box py={3}>\r\n            <Grid container spacing={2}>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"Name of Tale\"\r\n                        variant=\"outlined\"\r\n                        value={info.name}\r\n                        onChange={e => typingVal('name', e.target.value, info)}\r\n                        InputProps={info.name.length <= 0 && {\r\n                            endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                        }}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    {/* <TextField\r\n                        fullWidth\r\n                        label=\"Genre\"\r\n                        variant=\"outlined\"\r\n                        value={info.genre}\r\n                        onChange={e => typingVal('genre', e.target.value, info)}\r\n                    /> */}\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel id=\"demo-simple-select-outlined-label\">\r\n                            Genre\r\n                        </InputLabel>\r\n                        <Select\r\n                            labelId=\"demo-simple-select-outlined-label\"\r\n                            value={info.genre}\r\n                            fullWidth\r\n                            onChange={e => typingVal('genre', e.target.value, info)}\r\n                        >\r\n                            {\r\n                                GENRES.map(g => (\r\n                                    <MenuItem value={g.toUpperCase()} key={g}>\r\n                                        {g}\r\n                                    </MenuItem>\r\n                                ))\r\n                            }\r\n                        </Select>\r\n                    </FormControl>\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"Tags\"\r\n                        variant=\"outlined\"\r\n                        value={info.tags}\r\n                        onChange={e => typingVal('tags', e.target.value, info)}\r\n                    />\r\n                </Grid>\r\n                {/* <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"Language\"\r\n                        variant=\"outlined\"\r\n                        value={info.lang}\r\n                        onChange={e => typingVal('lang', e.target.value, info)}\r\n                        InputProps={info.lang.length <= 0 && {\r\n                            endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                        }}\r\n                    />\r\n                </Grid> */}\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <FormControl variant=\"outlined\" fullWidth>\r\n                        <InputLabel id=\"demo-simple-select-outlined-label\">\r\n                            Language\r\n                        </InputLabel>\r\n                        <Select\r\n                            labelId=\"demo-simple-select-outlined-label\"\r\n                            value={info.lang}\r\n                            fullWidth\r\n                            onChange={e => typingVal('lang', e.target.value, info)}\r\n                        >\r\n                            {\r\n                                LANGUAGES.map(l => (\r\n                                    <MenuItem value={l.toUpperCase()} key={l}>\r\n                                        {l}\r\n                                    </MenuItem>\r\n                                ))\r\n                            }\r\n                        </Select>\r\n                    </FormControl>\r\n                </Grid>\r\n                {/* <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField \r\n                        fullWidth \r\n                        label=\"Email\" \r\n                        variant=\"outlined\" \r\n                        value={user.email} \r\n                        disabled\r\n                        // onChange={e => typingVal('authorEmail', e.target.value, info)}\r\n                    />\r\n                </Grid> */}\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"Original Author (if any)\"\r\n                        variant=\"outlined\"\r\n                        placeholder=\"Original creator's name\"\r\n                        value={info.originalAuthor}\r\n                        onChange={e => typingVal('originalAuthor', e.target.value, info)}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3}>\r\n                    {!info.storyUrl &&\r\n                    <TextField\r\n                        fullWidth\r\n                        label=\"Custom URL\"\r\n                        variant=\"outlined\"\r\n                        value={info.desiredUrl}\r\n                        onChange={e => typingVal('desiredUrl', e.target.value, info)}\r\n                    />}\r\n                    {info.storyUrl &&\r\n                        <TextField\r\n                            fullWidth\r\n                            label=\"Fixed URL\"\r\n                            variant=\"outlined\"\r\n                            disabled\r\n                            value={'/' + info.storyUrl}\r\n                        />\r\n                    }\r\n                    {/* <Tooltip\r\n                        PopperProps={{\r\n                            disablePortal: true,\r\n                        }}\r\n                        onClose={() => {}}\r\n                        open={true}\r\n                        disableFocusListener\r\n                        disableHoverListener\r\n                        disableTouchListener\r\n                        title=\"Add\"\r\n                        placement=\"left\"\r\n                    >\r\n                        <InfoIcon />\r\n                    </Tooltip> */}\r\n                </Grid>\r\n                <Grid item xs={12}>\r\n                    <TextField\r\n                        label=\"Brief description\"\r\n                        multiline\r\n                        rows=\"4\"\r\n                        fullWidth\r\n                        variant=\"outlined\"\r\n                        value={info.description}\r\n                        onChange={e => typingVal('description', e.target.value, info)}\r\n                        InputProps={info.description.length <= 100 && {\r\n                            endAdornment: <InputAdornment position=\"end\"><ErrorOutlineIcon /></InputAdornment>,\r\n                        }}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    info: state.wipTale.info,\r\n    user: state.user\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    typingVal: (key, val, oldInfo) => updateTaleInfo(dispatch, key, val, oldInfo)\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTaleIntro)","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Box from '@material-ui/core/Box'\r\nimport {connect} from 'react-redux'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faTrashAlt } from '@fortawesome/free-solid-svg-icons'\r\nimport {\r\n    CHOICE_UPDATE_TEXT, \r\n    STORYBOARD_SELECT_CHOICE,\r\n    STORYBOARD_INSERT_AT\r\n} from '../../../redux/actionTypes'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    choiceBox: {\r\n        position: \"relative\",\r\n        margin: theme.spacing(1),\r\n        flexGrow: 1\r\n    },\r\n    selectChoice: {\r\n        position: \"absolute\",\r\n        top: -theme.spacing(1),\r\n        left: -theme.spacing(1)\r\n    },\r\n    choiceText: {\r\n        width: \"100%\",\r\n        '& > div': {\r\n            paddingTop: 30\r\n        }\r\n    },\r\n    idTag: {\r\n        fontSize: 13,\r\n        display: 'inline-block',\r\n        backgroundColor: '#eee',\r\n        padding: '1px 5px',\r\n        borderRadius: 2,\r\n        position: 'absolute',\r\n        top: theme.spacing(.5),\r\n        left: theme.spacing(3.5)\r\n        // '& input': {\r\n        //     fontSize: 14,\r\n        //     backgroundColor: 'inherit',\r\n        //     outline: 'none',\r\n        //     border: 'none',\r\n        //     width: 60\r\n        // }\r\n    },\r\n    btnPanel: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        right: 0,\r\n        zIndex: 9,\r\n        '& .ico': {\r\n            boxSizing: 'content-box',\r\n            padding: \"5px 7px\",\r\n            color: theme.palette.primary.main,\r\n            cursor: 'pointer',\r\n            borderRadius: '50%',\r\n            verticalAlign: \"middle\",\r\n            fontSize: 16,\r\n            display: 'inline-block'\r\n        },\r\n        '& .ico:active': {\r\n            backgroundColor: '#eee'\r\n        }\r\n    }\r\n}))\r\n\r\nconst updateChoiceText = (dispatch, cID, value) => {\r\n    dispatch({\r\n        type: CHOICE_UPDATE_TEXT,\r\n        payload: {cID, value}\r\n    })\r\n}\r\n\r\nconst selectChoice = (dispatch, cID, isSelected, sbI, nextStID) => {\r\n    cID = isSelected ? cID : '' // blank if Deselcetd\r\n\r\n    // Select The Choice\r\n    dispatch({\r\n        type: STORYBOARD_SELECT_CHOICE,\r\n        payload: {sbI, cID}\r\n    })\r\n\r\n    // Update the storyboard\r\n    // Rollback upto this sbI (storyboard Index)\r\n    // And Insert nextStID\r\n    // Optionally pass isRemoveOnly for Deselection\r\n    dispatch({\r\n        type: STORYBOARD_INSERT_AT,\r\n        payload: { sbI, nextStID, isRemoveOnly: !isSelected }\r\n    })\r\n}\r\n\r\nconst Choice = props => {\r\n    const classes = useStyles()\r\n    const { c, stID, sbI } = props\r\n    return (\r\n        <Box className={classes.choiceBox}>\r\n            <div className={classes.idTag}>\r\n                <span>ID: {c.id}</span>\r\n            </div>\r\n            <div className={classes.btnPanel}>\r\n                <FontAwesomeIcon icon={faTrashAlt} className=\"ico\" />\r\n            </div>\r\n            <TextField\r\n                // label=\"Choice text\"\r\n                placeholder=\"Enter choice text here\"\r\n                multiline\r\n                rows=\"3\"\r\n                variant=\"outlined\"\r\n                className={classes.choiceText}\r\n                value={c.text}\r\n                onChange={e => props.typingChoiceText(c.id, e.target.value)}\r\n            />\r\n            <Checkbox\r\n                checked={props.isSelected}\r\n                onChange={(e) => props.handleSelection(stID, c.id, e.target.checked, sbI, c.next)}\r\n                value=\"primary\"\r\n                className={classes.selectChoice}\r\n                inputProps={{ 'aria-label': 'primary checkbox' }}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\nconst mapDispatchToProps = dispatch => ({\r\n    typingChoiceText: (cID, value) => updateChoiceText(dispatch, cID, value),\r\n    handleSelection: (stID, cID, isSelected, sbI, nextStID) => selectChoice(dispatch, cID, isSelected, sbI, nextStID)\r\n})\r\nexport default connect(null, mapDispatchToProps)(Choice)","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        fontFamily: \"Georgia, serif\",\r\n        fontSize: 20,\r\n        fontWeight: 'bold',\r\n        // transform: 'scaleX(0.72)',\r\n        display: 'inline-block',\r\n        transition: \"fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms\"\r\n    }\r\n}))\r\n\r\nconst ReactoIcon = props => {\r\n    const classes = useStyles()\r\n    const { className } = props\r\n    return (\r\n        <span {...props} className={clsx(className, classes.root)}>((r))</span>\r\n    )\r\n}\r\n\r\nexport default ReactoIcon","import React from 'react'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Box from '@material-ui/core/Box'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Choice from './Choice'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faEye, faPencilAlt, faTrashAlt } from '@fortawesome/free-solid-svg-icons'\r\nimport AddIcon from '@material-ui/icons/AddBox'\r\nimport ReactoIcon from '../../common/icons/ReactoIcon'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { connect } from 'react-redux'\r\nimport { STORYLET_UPDATE_FIELD } from '../../../redux/actionTypes'\r\nimport { actionCreateChoice } from '../../../redux/actionCreators/createTaleActions'\r\nimport { orange } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    textField: {\r\n        display: \"flex\",\r\n        marginTop: theme.spacing(2)\r\n    },\r\n    box: {\r\n        border: `5px double ${orange[500]}`,\r\n        borderRadius: 4,\r\n        position: \"relative\"\r\n    },\r\n    title: {\r\n        border: `5px double ${orange[500]}`,\r\n        position: \"absolute\",\r\n        background: '#fff',\r\n        padding: '0 5px',\r\n        borderRadius: 4,\r\n        top: -20,\r\n        left: 8,\r\n        fontSize: 14\r\n    },\r\n    joiner: {\r\n        position: \"absolute\",\r\n        height: theme.spacing(5),\r\n        borderLeft: `5px double ${orange[500]}`,\r\n        width: 1,\r\n        left: \"50%\",\r\n        top: -45\r\n    },\r\n    choiceContainer: {\r\n        display: \"flex\",\r\n        flexWrap: \"wrap\",\r\n        justifyContent: \"space-between\"\r\n    },\r\n    addChoiceBtn: {\r\n        alignSelf: \"center\",\r\n        height: 90,\r\n        borderRadius: 6,\r\n        margin: `0 ${theme.spacing(1)}px`,\r\n        textAlign: \"center\",\r\n        fontSize: 16,\r\n        lineHeight: \" 20px\",\r\n        '& span': {\r\n            display: \"block\"\r\n        },\r\n        '& svg': {\r\n            fontSize: 36\r\n        }\r\n    },\r\n    idTag: {\r\n        fontSize: 14,\r\n        display: 'inline-block',\r\n        backgroundColor: '#eee',\r\n        padding: '2px 5px',\r\n        borderRadius: 2,\r\n        '& .ico': {\r\n\r\n        }\r\n        // '& input': {\r\n        //     fontSize: 14,\r\n        //     backgroundColor: 'inherit',\r\n        //     outline: 'none',\r\n        //     border: 'none',\r\n        //     width: 60\r\n        // }\r\n    },\r\n    btnPanel: {\r\n        position: \"absolute\",\r\n        top: 0,\r\n        right: 0,\r\n        '& .ico': {\r\n            boxSizing: 'content-box',\r\n            padding: \"15px 8px\",\r\n            color: theme.palette.primary.main,\r\n            cursor: 'pointer',\r\n            borderRadius: '50%',\r\n            verticalAlign: \"middle\",\r\n            fontSize: 18,\r\n            display: 'inline-block'\r\n        },\r\n        '& .ico:active': {\r\n            backgroundColor: '#eee'\r\n        }\r\n    }\r\n}))\r\n\r\nconst Storylet = props => {\r\n    const classes = useStyles()\r\n    const { st, sbI, sbItem, createAChoice, choices, openFSE } = props\r\n    return (\r\n        <div>\r\n            {/* STORYLET BOX -- STARTS HERE */}\r\n            <Box className={classes.box} px={1} pb={2} pt={2}>\r\n                {(sbI !== 0) && <span className={classes.joiner}></span>}\r\n                <span className={classes.title}>Storylet</span>\r\n                <div className={classes.idTag}>\r\n                    <span>ID: {st.id}</span>\r\n                    {/* <input type=\"text\" value={st.id} disabled /> */}\r\n                </div>\r\n                <div className={classes.btnPanel}>\r\n                    <FontAwesomeIcon icon={faTrashAlt} className=\"ico\" />\r\n                    <ReactoIcon className=\"ico\" />\r\n                    <FontAwesomeIcon icon={faEye} className=\"ico\" />\r\n                    <FontAwesomeIcon \r\n                        icon={faPencilAlt} \r\n                        className=\"ico\" \r\n                        title=\"Edit this Storylet\" \r\n                        onClick={() => openFSE(st)}\r\n                    />\r\n                </div>\r\n                <form noValidate autoComplete=\"off\">\r\n                    <TextField\r\n                        label=\"Storylet title\"\r\n                        variant=\"outlined\"\r\n                        className={classes.textField}\r\n                        value={st.title}\r\n                        onChange={e => props.typingStValue(st.id, \"title\", e.target.value)}\r\n                    />\r\n                    <TextField\r\n                        label=\"Storylet body\"\r\n                        multiline\r\n                        rows=\"6\"\r\n                        variant=\"outlined\"\r\n                        className={classes.textField}\r\n                        value={st.text}\r\n                        onChange={e => props.typingStValue(st.id, \"text\", e.target.value)}\r\n                    />\r\n                </form>\r\n            </Box>\r\n            {/* STORYLET BOX -- ENDS HERE */}\r\n\r\n            {/* CHOICES BOX -- STARTS HERE */}\r\n            <Box className={classes.box} pt={2} pb={2} my={5}>\r\n                <span className={classes.joiner}></span>\r\n                <span className={classes.title}>Choices</span>\r\n                <div className={classes.choiceContainer}>\r\n                    {\r\n                        st.choices && st.choices.map(cID => (\r\n                            <Choice\r\n                                c={choices[cID]}\r\n                                stID={st.id}\r\n                                sbI={sbI}\r\n                                isSelected={sbItem.selectedCID === cID}\r\n                                key={cID}\r\n                            />\r\n                        ))\r\n                    }\r\n                    <Fab className={classes.addChoiceBtn} variant=\"extended\" color=\"primary\" onClick={() => createAChoice(props.st.id)}>\r\n                        <AddIcon />\r\n                        <span className=\"txt\">Add Choice</span>\r\n                    </Fab>\r\n                </div>\r\n\r\n            </Box>\r\n            {/* CHOICES BOX -- ENDS HERE */}\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nconst UpdateStField = (stID, fieldName, value, dispatch) => {\r\n    dispatch({\r\n        type: STORYLET_UPDATE_FIELD,\r\n        payload: {\r\n            stID, fieldName, value\r\n        }\r\n    })\r\n}\r\nconst mapStateToProps = state => ({\r\n    choices: state.wipTale.choices\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    typingStValue: (stID, fieldName, value) => UpdateStField(stID, fieldName, value, dispatch),\r\n    createAChoice: stID => dispatch(actionCreateChoice(stID))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Storylet)","import React, { createRef } from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { connect } from 'react-redux'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport SimpleModal from './SimpleModal'\r\nimport { \r\n    actionUpdateSTAllText,\r\n    actionUpdateCText\r\n} \r\nfrom '../../../redux/actionCreators/createTaleActions'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    fullScreen: {\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        overflow: 'auto'\r\n    },\r\n    textField: {\r\n        marginTop: 20,\r\n        '& textarea': {\r\n            minHeight: 'calc(100vh - 250px)'\r\n        }\r\n    },\r\n    btnPanel: {\r\n        display: 'flex',\r\n        justifyContent: \"flex-end\",\r\n        marginTop: 20,\r\n        '& button+button': {\r\n            marginLeft: 15\r\n        }\r\n    }\r\n  }))\r\n\r\nconst FullScreenEdit = props => {\r\n    const classes = useStyles()\r\n    const { component, handleClose, saveStValue, saveChValue } = props\r\n    const t = component && component.id[0]==='S' ? 'Storylet' : 'Choice'\r\n    const theForm = createRef()\r\n    const save = () => {\r\n        const compText = theForm.current.elements.compText.value\r\n        if (t === 'Storylet') {\r\n            const compTitle = theForm.current.elements.compTitle.value\r\n            saveStValue(component.id, compTitle, compText)\r\n        }\r\n        else if (t === 'Choice') {\r\n            saveChValue(component.id, compText)\r\n        }\r\n        handleClose()\r\n    }\r\n\r\n    return (\r\n        <SimpleModal\r\n            title={\"Edit \" + t}\r\n            {...props} \r\n            className={classes.fullScreen}\r\n            preventAutoSize={true}\r\n        >\r\n            \r\n            <Box>\r\n                <form noValidate autoComplete=\"off\" ref={theForm}>\r\n                    {(t === 'Storylet') && <TextField\r\n                        label=\"Storylet title\"\r\n                        variant=\"outlined\"\r\n                        defaultValue={component && component.title}\r\n                        fullWidth\r\n                        name=\"compTitle\"\r\n                    />}\r\n                    <TextField\r\n                        label={t + \" body\"}\r\n                        multiline\r\n                        variant=\"outlined\"\r\n                        defaultValue={component && component.text}\r\n                        fullWidth\r\n                        className={classes.textField}\r\n                        name=\"compText\"\r\n                    />\r\n                </form>\r\n\r\n                <Box className={classes.btnPanel}>\r\n                    <Button variant=\"outlined\" color=\"primary\" onClick={handleClose}>Cancel</Button>\r\n                    <Button variant=\"contained\" color=\"primary\" onClick={save}>Done</Button>\r\n                </Box>\r\n            </Box>\r\n\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    saveStValue: (stID, title, text) => dispatch(actionUpdateSTAllText(stID, title, text)),\r\n    saveChValue: (cID, value) => dispatch(actionUpdateCText(cID, value))\r\n})\r\n\r\nexport default connect(null, mapDispatchToProps)(FullScreenEdit)","import React, { useState } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Box from '@material-ui/core/Box';\r\nimport Storylet from '../../common/storylet/Storylet'\r\nimport FullScreenEdit from '../../common/modal/FullScreenEdit'\r\n\r\nconst CreateTaleBody = props => {\r\n    const [fseParam, setFSEParam] = useState({})    // Full Screen Edit    \r\n    const closeFSE = () => setFSEParam({})\r\n    // component is either a St or a Ch object\r\n    const openFSE = component => {\r\n        console.log(component)\r\n        setFSEParam({\r\n            component, isVisible: true\r\n        })\r\n    }\r\n\r\n    return (\r\n        <Box py={3}>\r\n            {\r\n                props.storyboard && props.storyboard.map( (sbItem, sbI) => {\r\n                    let st = props.storylets[sbItem.stID]\r\n                    return (\r\n                        <Storylet \r\n                            st={st} \r\n                            key={sbItem.stID} \r\n                            sbI={sbI} \r\n                            sbItem={sbItem} \r\n                            openFSE={openFSE}\r\n                        />\r\n                    )\r\n                })\r\n            }\r\n            <FullScreenEdit \r\n                isOpen={fseParam.isVisible}\r\n                handleClose={closeFSE}\r\n                component={fseParam.component}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    storyboard: state.wipTale.storyboard,\r\n    storylets: state.wipTale.storylets\r\n})\r\n\r\nexport default connect(mapStateToProps)(CreateTaleBody)","import React from 'react'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nimport Typography from '@material-ui/core/Typography';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Box from '@material-ui/core/Box';\r\nimport Button from '@material-ui/core/Button';\r\n\r\nconst ExportTaleModal = props => {\r\n    const {isOpen, handleClose, expTaleContent} = props\r\n    const textFieldRef = React.createRef()\r\n\r\n    const clickToCopy = textRef => {\r\n        console.log(textRef)\r\n        const t = textRef.current.getElementsByTagName('input').item(0)\r\n        /* Select the text field */\r\n        t.select()\r\n        t.setSelectionRange(0, 999999999) /*For mobile devices*/\r\n    \r\n        /* Copy the text inside the text field */\r\n        document.execCommand(\"copy\")\r\n    \r\n        /* Alert the copied text */\r\n        setTimeout(()=>{\r\n            alert(\"Text copied to clipboard ...\")\r\n        }, 0)\r\n    }\r\n\r\n    return (\r\n        <SimpleModal \r\n            isOpen={isOpen} \r\n            handleClose = {handleClose}\r\n            title=\"Export Reactale\"\r\n        >\r\n        <Typography variant=\"body1\" gutterBottom>\r\n            Copy this text and paste it in a text file in case file download is not working (e.g. in mobile browsers)\r\n        </Typography>\r\n\r\n        <Box my={3}>\r\n            <TextField \r\n                label=\"Outlined\" \r\n                variant=\"outlined\" \r\n                value={expTaleContent}\r\n                fullWidth\r\n                ref={textFieldRef}\r\n            />\r\n        </Box>\r\n        <Button variant=\"outlined\" color=\"primary\" onClick={() => clickToCopy(textFieldRef)}>\r\n            Copy Reactale Text\r\n        </Button>\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ExportTaleModal","export default {\r\n    exportTale: {\r\n        desc: \"Export this reactale\",\r\n        features: [\r\n            \"Export Reactale as both Text and File\",\r\n            \"Exported Reactale can be imported and worked on\",\r\n            \"Can be shared easily with reviewers and collaborator\",\r\n            \"Works offline (Internet not required)\"\r\n        ]\r\n    },\r\n    saveLocal: {\r\n        desc: \"Save this reactale in this device\",\r\n        features: [\r\n            \"Will be saved in this device's memory\",\r\n            \"Will not be available in other devices\",\r\n            \"Great choice if you use this device only for writing Reactale\",\r\n            \"Works offline (Internet not required)\"\r\n        ]\r\n    },\r\n    saveOnline: {\r\n        desc: \"Save this reactale online\",\r\n        features: [\r\n            \"Will be saved online in your logged in account\",\r\n            \"Availabe accross any device you login from\",\r\n            \"Great choice if you work from multiple devices\",\r\n            \"Internet is mandatory\"\r\n        ]\r\n    }\r\n}","import React from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport DoubleArrowIcon from '@material-ui/icons/DoubleArrow'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        position: 'relative',\r\n        padding: '5px 5px 5px 18px'\r\n    },\r\n    ico: {\r\n        position: 'absolute',\r\n        left: -2,\r\n        top: 7,\r\n        color: theme.palette.primary.main,\r\n        fontSize: 16\r\n    }\r\n}))\r\n\r\nconst Li = props => {\r\n    const classes = useStyles()\r\n    const { text, children } = props\r\n    return (\r\n        <li className={classes.root}>\r\n            <DoubleArrowIcon className={classes.ico}/>\r\n            {text || children}\r\n        </li>\r\n    )\r\n}\r\n\r\nexport default Li","import React, { useState } from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Container from '@material-ui/core/Container'\r\nimport Box from '@material-ui/core/Box'\r\nimport Grid from '@material-ui/core/Grid'\r\n// import Paper from '@material-ui/core/Paper'\r\n// import Typography from '@material-ui/core/Typography'\r\nimport Button from '@material-ui/core/Button'\r\nimport { connect } from 'react-redux'\r\nimport ExportTaleModal from './ExportTaleModal'\r\nimport { URL_CREATE_TALE, URL_CREATE_STORYURL } from '../../../utils/urls'\r\nimport { InfoCard } from '../../common/cards'\r\nimport featureText from './exportFeatureText'\r\nimport { Li } from '../../common/misc'\r\nimport axios from 'axios'\r\nimport {\r\n    actionSetTaleAsWIP\r\n} from '../../../redux/actionCreators/createTaleActions'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    cardHeaders: {\r\n        fontWeight: 500,\r\n        margin: 0,\r\n        textAlign: 'center',\r\n        color: theme.palette.primary.main\r\n    },\r\n    cardContainer: {\r\n        marginTop: theme.spacing(3)\r\n    },\r\n    cardInfo: {\r\n        minHeight: 50,\r\n        marginTop: 3\r\n    }\r\n}))\r\n\r\nfunction download (filename, text) {\r\n    var element = document.createElement('a');\r\n    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\r\n    element.setAttribute('download', filename);\r\n\r\n    element.style.display = 'none';\r\n    document.body.appendChild(element);\r\n\r\n    element.click();\r\n\r\n    document.body.removeChild(element);\r\n}\r\n\r\nconst CreateTaleFinish = props => {\r\n    const classes = useStyles()\r\n    const { wipTale, history, setTaleAsWIP, isLocalEdit } = props\r\n    const [isExpTaleModalVisible, setExpTModalVis] = useState(false)\r\n    const [expTale, setExpTale] = useState('')\r\n    const getWIPTale = () => {\r\n        const { storyboard, ...tale } = wipTale\r\n        return tale\r\n    }\r\n\r\n    const exportWIPTale = () => {\r\n        if(!areFieldsValid()) return\r\n\r\n        const tale = getWIPTale()\r\n        console.log(tale)\r\n        const content = btoa(encodeURIComponent((JSON.stringify(tale))))\r\n        download(`${tale.info.name.replace(/\\s+/g, '-')}-${tale.id}.rtl`, content)\r\n        setExpTale(content)\r\n        setExpTModalVis(true)\r\n    }\r\n\r\n    const saveTaleLocal = (rtl) => {\r\n        if(!areFieldsValid()) return\r\n        const tale = rtl || getWIPTale()\r\n        const allReactales = JSON.parse(window.localStorage.getItem(\"allReactales\")) || {}\r\n        allReactales[tale.id] = tale\r\n        window.localStorage.setItem(\"allReactales\", JSON.stringify(allReactales))\r\n        alert(\"Saved succesfully. \" + localStorageSpace())\r\n    }\r\n\r\n    const saveTaleOnline = async () => {\r\n        if(!areFieldsValid()) return\r\n\r\n        const tale = getWIPTale()\r\n\r\n        // This variable controls whether a redirection is required to /edit-tale/\r\n        // because of creating new unique storyUrl\r\n        // may be because local / offline tales are being saved for the 1st time\r\n        let needsRedirection = false\r\n        // console.log(tale)\r\n\r\n        // If StoryUrl has never been set\r\n        if (!tale.info.storyUrl) {\r\n            let res = await axios.post(URL_CREATE_STORYURL, {storyUrl: tale.info.desiredUrl || ''})\r\n            \r\n            tale.info.storyUrl = res.data.suggestedUrl\r\n            needsRedirection = true\r\n        }\r\n\r\n        axios.post(URL_CREATE_TALE, tale)\r\n        .then(res => {\r\n            console.log(res.data)\r\n            let {status, tale} = res.data\r\n            if(status === 200) {\r\n                alert('Tale saved online successfully...')\r\n                tale = JSON.parse(tale)\r\n                setTaleAsWIP(tale)\r\n                if(isLocalEdit) {\r\n                    saveTaleLocal(tale)\r\n                }\r\n                if (needsRedirection) {\r\n                    history.push(`/edit-tale/${tale.info.storyUrl}`)\r\n                }\r\n            }\r\n            else {\r\n                console.log(\"most probably some error occurred\")\r\n            }\r\n        })\r\n        .catch(err =>{\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * It will check throught all the field validation\r\n     * And show message + return boolean depending on it\r\n     */\r\n    const areFieldsValid = rtl => {\r\n        const tale = rtl || getWIPTale()\r\n        const { name, description, genre, lang, tags } = tale.info\r\n\r\n        if(!name || !description || !genre || !lang || !tags) {\r\n            alert('Fill all the mandatory fields viz. name, description, genre, language, tags')\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n\r\n    const localStorageSpace = () => {\r\n        var allStrings = '';\r\n        for (var key in window.localStorage) {\r\n            if (window.localStorage.hasOwnProperty(key)) {\r\n                allStrings += window.localStorage[key];\r\n            }\r\n        }\r\n        return allStrings ? 3 + ((allStrings.length * 16) / (8 * 1024)) + ' KB' : 'Empty (0 KB)';\r\n    };\r\n\r\n    return (\r\n        <Box pb={10}>\r\n            <ExportTaleModal \r\n                isOpen = {isExpTaleModalVisible}\r\n                handleClose = {() => setExpTModalVis(false)}\r\n                expTaleContent = {expTale}\r\n            />\r\n            <Container maxWidth=\"md\">\r\n                <Grid container spacing={2}>\r\n                    <Grid item xs={12} sm={4} className={classes.cardContainer}>\r\n                        <InfoCard>\r\n                            <h2 className={classes.cardHeaders}>Export Reactale</h2>\r\n                            <span className={classes.cardInfo}>{featureText.exportTale.desc}</span>\r\n\r\n                            <h3 className={classes.cardHeaders}>Pros &amp; Cons</h3>\r\n                            <ul className=\"fillmid\">\r\n                                {\r\n                                    featureText.exportTale.features.map( t => \r\n                                        <Li key={t}>{t}</Li>\r\n                                    )\r\n                                }\r\n                            </ul>\r\n\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={exportWIPTale}\r\n                            >\r\n                                Export Reactale\r\n                            </Button>\r\n                        </InfoCard>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={4} className={classes.cardContainer}>\r\n                        <InfoCard>\r\n                            <h2 className={classes.cardHeaders}>Save Offline</h2>\r\n                            <span className={classes.cardInfo}>{featureText.saveLocal.desc}</span>\r\n\r\n                            <h3 className={classes.cardHeaders}>Pros &amp; Cons</h3>\r\n                            <ul className=\"fillmid\">\r\n                                {\r\n                                    featureText.saveLocal.features.map( t => \r\n                                        <Li key={t}>{t}</Li>\r\n                                    )\r\n                                }\r\n                            </ul>\r\n\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={saveTaleLocal}\r\n                            >\r\n                                Save Offline\r\n                            </Button>\r\n                        </InfoCard>\r\n                    </Grid>\r\n                    <Grid item xs={12} sm={4} className={classes.cardContainer} >\r\n                        <InfoCard>\r\n                            <h2 className={classes.cardHeaders}>Save Online</h2>\r\n                            <span className={classes.cardInfo}>{featureText.saveOnline.desc}</span>\r\n\r\n                            <h3 className={classes.cardHeaders}>Pros &amp; Cons</h3>\r\n                            <ul className=\"fillmid\">\r\n                                {\r\n                                    featureText.saveOnline.features.map( t => \r\n                                        <Li key={t}>{t}</Li>\r\n                                    )\r\n                                }\r\n                            </ul>\r\n\r\n                            <Button\r\n                                variant=\"contained\"\r\n                                color=\"primary\"\r\n                                onClick={saveTaleOnline}\r\n                            >\r\n                                Save Online\r\n                            </Button>\r\n                        </InfoCard>\r\n                    </Grid>\r\n                </Grid>\r\n            </Container>\r\n            {/* <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"margin-right-15 margin-top-15\"\r\n                onClick={exportWIPTale}\r\n            >\r\n                Export this Reactale\r\n            </Button>\r\n            <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"margin-right-15 margin-top-15\"\r\n                onClick={saveTaleLocal}\r\n            >\r\n                Save in local\r\n            </Button>\r\n            <Button\r\n                variant=\"contained\"\r\n                color=\"primary\"\r\n                className=\"margin-top-15\"\r\n                onClick={saveTaleOnline}\r\n            >\r\n                Save Online\r\n            </Button> */}\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    wipTale: state.wipTale\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    setTaleAsWIP: (tale) => dispatch(actionSetTaleAsWIP(tale))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTaleFinish)","import React, { useState, useEffect, useCallback } from 'react'\r\n// import { makeStyles } from '@material-ui/core/styles'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport AccountTreeIcon from '@material-ui/icons/AccountTree'\r\nimport InputIcon from '@material-ui/icons/Input'\r\nimport VisibilityIcon from '@material-ui/icons/Visibility'\r\nimport ImportTaleModal from './ImportTaleModal'\r\nimport CreateTaleIntro from './CreateTaleIntro'\r\nimport CreateTaleBody from './CreateTaleBody'\r\nimport CreateTaleFinish from './CreateTaleFinish'\r\nimport { startsWith } from '../../../utils/util'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    actionCreateNewTale,\r\n    actionSaveTaleAndReset,\r\n    actionSetTaleAsWIP\r\n} from '../../../redux/actionCreators/createTaleActions'\r\nimport { LOCAL_TALE_IDENTIFIER } from '../../../utils/constants' \r\n\r\nimport { URL_GET_STORY } from \"../../../utils/urls\";\r\nimport axios from 'axios'\r\n\r\nconst CreateTale = props => {\r\n    const [visibleTabIndex, setVisibleTab] = useState(0)\r\n    const [pageTitle, setPageTitle] = useState(\"Create\")\r\n    const [isImportModalOpen, setIsImportModalOpen] = useState(false)\r\n    const { createNewTale, saveAndResetAll, match, setTaleAsWIP, history, _id, _storyUrl } = props\r\n    const [isLocalEdit, setIsLocalEdit] = useState(false)\r\n    const handleTabSwitch = (event, newValue) => {\r\n        setVisibleTab(newValue)\r\n    }\r\n\r\n    const goTo = url => history.push(url)\r\n\r\n    const setReactaleForEditing = useCallback(() => {\r\n        let storyUrl = match.params.id\r\n        // console.log(storyID)\r\n\r\n        // If it is a local story\r\n        // Then the ID should start with \"local\"\r\n        if (storyUrl.indexOf(LOCAL_TALE_IDENTIFIER) >= 0) {\r\n            setIsLocalEdit(true)\r\n            storyUrl = storyUrl.trim().replace(LOCAL_TALE_IDENTIFIER, \"\")\r\n            const allReactales = JSON.parse(window.localStorage.getItem(\"allReactales\")) || {}\r\n            const theTale = allReactales[storyUrl]\r\n            setTaleAsWIP(theTale)\r\n        }\r\n\r\n        // Else fetch it online\r\n        else {\r\n            // If we already have the data, no need to call BE\r\n            if(_storyUrl === storyUrl) {\r\n                return\r\n            }\r\n\r\n            // else call BE\r\n            axios.post(URL_GET_STORY, {storyUrl})\r\n            .then(res => {\r\n                console.log(res.data)\r\n                let {status, tale} = res.data\r\n                if(status === 200) {\r\n                    tale = JSON.parse(tale)\r\n                    setTaleAsWIP(tale)\r\n                }\r\n                else {\r\n                    console.log(\"most probably some error occurred\")\r\n                }\r\n            })\r\n            .catch(err =>{\r\n                console.log(err)\r\n            })\r\n        }\r\n    }, [match, setTaleAsWIP, _storyUrl])\r\n\r\n    const setImportedTaleForEditing = tale => {\r\n        setTaleAsWIP(tale)\r\n        setIsImportModalOpen(false)\r\n    }\r\n\r\n    useEffect(() => {\r\n        // if already an ID is present,\r\n        // then already a story is in progress of create / edit\r\n        if (match.url === '/create-tale' && !_id) {\r\n            createNewTale()\r\n        }\r\n        // edting current in progress tale\r\n        // coming back from FLowTale\r\n        else if(startsWith(match.url, '/edit-tale/current')) {\r\n            // Do nothing\r\n            console.log('back from TalesFlow')\r\n        }\r\n        // else Edit Reactale\r\n        else if (startsWith(match.url, '/edit-tale/')) {\r\n            setPageTitle(\"Edit\")\r\n            setReactaleForEditing()\r\n        }\r\n        // Already something in progress\r\n        // Do nothing\r\n        else {\r\n            console.log('Forbidden case inside create-edit... else case...')\r\n        }\r\n\r\n        return (() => {\r\n            console.log(\"Leaving Story Create Page... Now is a good time to save changes so far...\")\r\n            //saveAndResetAll()\r\n        })\r\n    }, [createNewTale, saveAndResetAll, match, setReactaleForEditing, _id])\r\n\r\n    return (\r\n        <Box py={2}>\r\n            \r\n            <Typography variant=\"h4\" component=\"h1\">\r\n                {pageTitle} Reactale\r\n            </Typography>\r\n            \r\n            <Box mt={2} mb={4} className=\"flex-space-between\">\r\n                <Typography variant=\"subtitle1\">\r\n                    {pageTitle} a Reactale or import one to edit it.\r\n                </Typography>\r\n                \r\n                <Box>\r\n                    <Button \r\n                        variant=\"contained\" \r\n                        color=\"primary\"\r\n                        className=\"margin-right-15 margin-top-15\"\r\n                        startIcon={<InputIcon />}\r\n                        onClick={() => setIsImportModalOpen(true)}\r\n                    >\r\n                        Import\r\n                    </Button>\r\n                    <Button \r\n                        variant=\"contained\" \r\n                        color=\"primary\"\r\n                        className=\"margin-right-15 margin-top-15\"\r\n                        startIcon={<VisibilityIcon />}\r\n                        // onClick={preview}\r\n                    >\r\n                        Preview\r\n                    </Button>\r\n                    <Button \r\n                        variant=\"contained\" \r\n                        color=\"primary\"\r\n                        className=\"margin-top-15\"\r\n                        startIcon={<span className=\"talesflowicon\"><AccountTreeIcon /></span>}\r\n                        onClick={() => goTo('/tales-flow')}\r\n                    >\r\n                        TalesFlow\r\n                    </Button>\r\n                </Box>\r\n                \r\n            </Box>\r\n\r\n            <Paper square>\r\n                <Tabs\r\n                    value={visibleTabIndex}\r\n                    indicatorColor=\"primary\"\r\n                    textColor=\"primary\"\r\n                    onChange={handleTabSwitch}\r\n                    centered\r\n                    aria-label=\"tabs to create the story\"\r\n                >\r\n                    <Tab label=\"Intro\" />\r\n                    <Tab label=\"Body\" />\r\n                    <Tab label=\"Finish\" />\r\n                </Tabs>\r\n            </Paper>\r\n            \r\n            <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                <CreateTaleIntro />\r\n            </Box>\r\n\r\n            <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                <CreateTaleBody />\r\n            </Box>\r\n\r\n            <Box className={visibleTabIndex !== 2 ? 'hide' : ''}>\r\n                <CreateTaleFinish history={history} isLocalEdit={isLocalEdit} />\r\n            </Box>\r\n\r\n            {/* Import Tale Modal */}\r\n            <ImportTaleModal \r\n                isOpen={isImportModalOpen} \r\n                handleClose = {() => setIsImportModalOpen(false)}\r\n                setForEditing = {setImportedTaleForEditing}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\nconst mapStateToProps = state => ({\r\n    _id: state.wipTale.id,\r\n    _storyUrl: state.wipTale.info.storyUrl\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    createNewTale: () => dispatch(actionCreateNewTale()),\r\n    saveAndResetAll: () => dispatch(actionSaveTaleAndReset()),\r\n    setTaleAsWIP: (tale) => dispatch(actionSetTaleAsWIP(tale))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CreateTale)","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Box from '@material-ui/core/Box'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\r\nimport AddBoxIcon from '@material-ui/icons/AddBox'\r\nimport GamepadIcon from '@material-ui/icons/Gamepad'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport SaveIcon from '@material-ui/icons/Save'\r\nimport TouchAppIcon from '@material-ui/icons/TouchApp'\r\nimport CreateIcon from '@material-ui/icons/Create';\r\nimport OpenWithIcon from '@material-ui/icons/OpenWith';\r\nimport { red } from '@material-ui/core/colors'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { faMagic, faMousePointer, faPencilAlt } from '@fortawesome/free-solid-svg-icons'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    panel: {\r\n        width: 40,\r\n        backgroundImage: `linear-gradient(${theme.palette.primary.main}, ${theme.palette.primary.dark})`,\r\n        position: 'absolute',\r\n        left: 0,\r\n        top: 50,\r\n        height: \"calc(100vh - 60px)\",\r\n        overflow: \"auto\"\r\n    },\r\n    btnPane: {\r\n        color: '#fff',\r\n        padding: `${theme.spacing(2)}px 0`,\r\n        '& li': {\r\n            height: 44,\r\n            display: 'flex',\r\n            justifyContent: 'center',\r\n            alignItems: 'center'\r\n        },\r\n        '& li+li': {\r\n            borderTop: '1px solid #fff'\r\n        },\r\n        '& li:active': {\r\n            backgroundColor: red.A400\r\n        },\r\n        '& li svg': {\r\n            fontSize: 27\r\n        }\r\n    },\r\n    fa: {\r\n        fontSize: '24px !important'\r\n    },\r\n    autoMagic: {\r\n        transform: 'rotate(-90deg)'\r\n    },\r\n    toggleJStick: {\r\n        // transform: 'rotate(45deg)',\r\n        // fontSize: '26px !important' \r\n    }\r\n}))\r\n\r\nconst ControlPanel = props => {\r\n    const classes = useStyles()\r\n    const { history, deleteComponent, paintFlowboard, toggleJStick, openFSE } = props\r\n    const backToEdit = () => history.push('/edit-tale/current')\r\n    return (\r\n        <Box className={classes.panel}>\r\n            <ul className={classes.btnPane}>\r\n                <li title=\"Back to Editor\" onClick={backToEdit}><ArrowBackIcon /></li>\r\n                <li title=\"Add component\"><AddBoxIcon /></li>\r\n                <li title=\"Select component\"><FontAwesomeIcon icon={faMousePointer} className={classes.fa} /></li>\r\n                <li title=\"Edit component\" onClick={openFSE}><FontAwesomeIcon icon={faPencilAlt} className={classes.fa} /></li>\r\n                <li title=\"Save all\"><SaveIcon /></li>\r\n                <li title=\"Toggle joystick\" onClick={toggleJStick}><OpenWithIcon className={classes.toggleJStick} /></li>\r\n                {/* <li title=\"Auto format\" onClick={paintFlowboard}><GavelIcon /></li> */}\r\n                <li title=\"Auto format\" onClick={paintFlowboard}><FontAwesomeIcon icon={faMagic} className={clsx(classes.fa, classes.autoMagic)} /></li>\r\n                <li title=\"Increase draw area\"><ZoomOutMapIcon /></li>\r\n                <li title=\"Delete selected\" onClick={deleteComponent}><DeleteIcon /></li>\r\n            </ul>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default ControlPanel","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Left from '@material-ui/icons/KeyboardArrowLeft'\r\nimport Right from '@material-ui/icons/KeyboardArrowRight'\r\nimport Up from '@material-ui/icons/KeyboardArrowUp'\r\nimport Down from '@material-ui/icons/KeyboardArrowDown'\r\nimport { red } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    container: {\r\n        position: \"absolute\"\r\n    },\r\n    btn: {\r\n        position: \"absolute\",\r\n        fontSize: 30,\r\n        backgroundColor: red[100],\r\n        borderRadius: 6,\r\n        '&:active': {\r\n            backgroundColor: red[300]\r\n        }\r\n    },\r\n    left: {\r\n        left: 0,\r\n        top: 0\r\n    },\r\n    right: {\r\n        left: 60,\r\n        top: 0\r\n    },\r\n    up: {\r\n        left: 30,\r\n        top: -30\r\n    },\r\n    down: {\r\n        left: 30,\r\n        top: 30\r\n    }\r\n}))\r\n\r\nconst JoyStick = props => {\r\n    const classes = useStyles()\r\n    const { moveLeft, moveRight, moveUp, moveDown } = props\r\n    return (\r\n        <div className={classes.container}>\r\n            <Left className={clsx(classes.btn, classes.left)} onClick={moveLeft} />\r\n            <Right className={clsx(classes.btn, classes.right)} onClick={moveRight} />\r\n            <Up className={clsx(classes.btn, classes.up)} onClick={moveUp} />\r\n            <Down className={clsx(classes.btn, classes.down)} onClick={moveDown} />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default JoyStick","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { \r\n    FLOW_ST_WIDTH, \r\n    FLOW_ST_HEIGHT,\r\n    FLOW_KNOW_RAD,\r\n    FLOW_KNOT_IN_X,\r\n    FLOW_KNOT_IN_Y,\r\n    FLOW_KNOT_OUT_X,\r\n    FLOW_KNOT_OUT_Y\r\n} from '../../../utils/constants'\r\nimport { red } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    cg: {\r\n        transform: \"translate(100px, 100px)\"\r\n    },\r\n    knot: {\r\n        fill: red[500],\r\n        strokeWidth: 1,\r\n        stroke: red[500]\r\n    },\r\n    selectedKnot: {\r\n        // fill: '#000',\r\n        strokeWidth: 3,\r\n        stroke: '#000'\r\n    },\r\n    selectedEl: {\r\n        stroke: '#00f'\r\n    },\r\n    rect: {\r\n        fill: \"#fff\",\r\n        strokeWidth: 1,\r\n        stroke: theme.palette.primary.main\r\n    },\r\n    selectedST: {\r\n        '& rect': {\r\n            fill: red[500],\r\n            stroke: red[500]\r\n        },\r\n        '& text': {\r\n            fill: '#fff'\r\n        }\r\n    },\r\n    title: {\r\n        fontSize: 14\r\n    },\r\n    stid: {\r\n        fontSize: 14,\r\n        fill: \"#000\"\r\n    }\r\n}))\r\n\r\nconst FlowST = props => {\r\n    const classes = useStyles()\r\n    const { stid, title, transformStyle, start, selectedObj, handleSelection, handleMouseDown, handleMouseUp, handleMouseMove } = props\r\n    const markSelected = (e, type) => {\r\n        e.stopPropagation()\r\n        handleSelection(stid, type)\r\n    }\r\n    return (\r\n        <g \r\n            id={stid} \r\n            className={classes.cg} \r\n            style={transformStyle}\r\n            onMouseDown={e => handleMouseDown(e, stid)}\r\n            onMouseUp={e => handleMouseUp(e)}\r\n            onMouseMove={e => handleMouseMove(e)}\r\n        >\r\n\r\n            {(stid === start) && <text x=\"55\" y=\"-3\" fill=\"blue\">START</text>}\r\n            \r\n            {(stid !== start) \r\n                && \r\n                <circle \r\n                    className={clsx(classes.knot, ((selectedObj.id===stid && 'IN'===selectedObj.type) && classes.selectedKnot))} \r\n                    cx={FLOW_KNOT_IN_X} \r\n                    cy={FLOW_KNOT_IN_Y} \r\n                    r={FLOW_KNOW_RAD}\r\n                    onClick={e => markSelected(e, 'IN')}\r\n                >\r\n                </circle>}\r\n            \r\n            <circle \r\n                className={clsx(classes.knot, ((selectedObj.id===stid && 'OUT'===selectedObj.type) && classes.selectedKnot))} \r\n                cx={FLOW_KNOT_OUT_X} \r\n                cy={FLOW_KNOT_OUT_Y} \r\n                r={FLOW_KNOW_RAD}\r\n                onClick={e => markSelected(e, 'OUT')}\r\n            >\r\n            </circle>\r\n            \r\n            <g className={clsx((selectedObj.id===stid && 'ST'===selectedObj.type) && classes.selectedST)} onClick={e => markSelected(e, 'ST')}>\r\n                <rect \r\n                    className={classes.rect}\r\n                    width={FLOW_ST_WIDTH} \r\n                    height={FLOW_ST_HEIGHT}>\r\n                </rect>\r\n\r\n                <text x=\"5\" y=\"15\" className={classes.title}>{title.substr(0, 20) || 'Click Edit to add text'}</text>\r\n                <text x=\"5\" y=\"30\" className={classes.title}>{title.substr(20, 20)}</text>\r\n                {/* <text x=\"5\" y=\"32\" class=\"title el\">{st.title.substr(44, 22)}</text> */}\r\n\r\n                <text x=\"5\" y=\"45\" className={classes.stid}>{stid}</text>\r\n            </g>\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default FlowST","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { red } from '@material-ui/core/colors'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    connector: {\r\n        strokeWidth: 4,\r\n        stroke: red[200]\r\n    },\r\n    cid: {\r\n        fontSize: 16,\r\n        fontWeight: 'bold',\r\n        fill: red[500]\r\n    },\r\n    selectedConnector: {\r\n        '& line': {\r\n            stroke: red[900]\r\n        },\r\n        '& text': {\r\n            fill: '#000'\r\n        }\r\n    }\r\n}))\r\n\r\nconst FlowConnector = props => {\r\n    const classes = useStyles()\r\n    const { c, selectedObj, handleSelection } = props\r\n    const markSelected = e => {\r\n        e.stopPropagation()\r\n        handleSelection(c.cid, 'CH')\r\n    }\r\n    return (\r\n        <g \r\n            className={clsx((c.cid === selectedObj.id && 'CH' === selectedObj.type) && classes.selectedConnector)}\r\n            onClick={markSelected}\r\n        >\r\n            \r\n            <line \r\n            id={c.id}\r\n            x1={c.x1} y1={c.y1} \r\n            x2={c.x2} y2={c.y2}\r\n            className={classes.connector}>\r\n            </line>\r\n\r\n            <text className={classes.cid} \r\n            x={(c.x1 + c.x2) / 2} \r\n            y={(c.y1 + c.y2) / 2}>\r\n                {c.cid}\r\n            </text>\r\n        </g>\r\n    )\r\n}\r\n\r\nexport default FlowConnector","import React, { useState, useEffect } from 'react'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Box from '@material-ui/core/Box'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Button from '@material-ui/core/Button'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    modelST: {\r\n        height: 70,\r\n        border: `2px solid ${theme.palette.primary.main}`,\r\n        padding: theme.spacing(1),\r\n        textAlign: \"center\",\r\n        fontSize: 14,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'center',\r\n        borderRadius: 4\r\n    },\r\n    modelCon: {\r\n        height: 50,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'center',\r\n        textAlign: 'center',\r\n        '& .con': {\r\n            height: 1,\r\n            borderTop: `2px dashed ${theme.palette.primary.main}`\r\n        }\r\n    },\r\n    btnPanel: {\r\n        display: 'flex',\r\n        marginTop: theme.spacing(2),\r\n        '& button': {\r\n            flex: 1\r\n        },\r\n        '& button+button': {\r\n            marginLeft: theme.spacing(2)\r\n        }\r\n    }\r\n}))\r\n\r\nexport const ModalEditChoice = props => {\r\n    const classes = useStyles()\r\n    const { fromStID, toStID, type, text, handleSave, handleClose } = props\r\n    // console.log(props)\r\n    const [txt, setTxt] = useState('')\r\n    useEffect(() => setTxt(text), [text])\r\n    const title = type + \" a Choice\"\r\n    return (\r\n        <SimpleModal\r\n            {...props}\r\n            title={title}\r\n        >\r\n            <Box mb={3} mt={1}>\r\n                <Grid container>\r\n                    <Grid item xs>\r\n                        <div className={classes.modelST}>Storylet {fromStID}</div>\r\n                    </Grid>\r\n                    <Grid item xs className={classes.modelCon}>\r\n                        <span>to</span>\r\n                        <div className=\"con\"></div>\r\n                    </Grid>\r\n                    <Grid item xs>\r\n                        <div className={classes.modelST}>Storylet {toStID}</div>\r\n                    </Grid>\r\n                </Grid>\r\n            </Box>\r\n            {/* <Box mt={1} mb={2}>\r\n                {t} (connector) from storylet {fromStID} to storylet {toStID}\r\n            </Box> */}\r\n            <TextField label=\"Choice Text\" \r\n                value={txt} onChange={e => setTxt(e.target.value)}\r\n                variant=\"outlined\" fullWidth \r\n            />\r\n\r\n            <Box className={classes.btnPanel}>\r\n                <Button variant=\"outlined\" color=\"primary\" \r\n                    onClick={handleClose}\r\n                >\r\n                    Cancel\r\n                </Button>\r\n\r\n                <Button variant=\"contained\" color=\"primary\" \r\n                    onClick={() => handleSave(fromStID, toStID, txt, type)}\r\n                >\r\n                    Done\r\n                </Button>\r\n            </Box>\r\n\r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nexport default ModalEditChoice","import {\r\n    FLOW_ST_WIDTH,\r\n    FLOW_ST_HEIGHT,\r\n    FLOW_WIRE_SHIFT_X,\r\n    FLOW_WIRE_SHIFT_FROM_Y,\r\n    FLOW_WIRE_SHIFT_TO_Y,\r\n    FLOW_H_GAP,\r\n    FLOW_V_GAP,\r\n    FLOW_H_SHIFT,\r\n    FLOW_V_SHIFT\r\n} from '../../../utils/constants'\r\n\r\nexport {\r\n    createFlowboard, \r\n    getTransformStyle,\r\n    createFlowConnectors\r\n}\r\n\r\nfunction createFlowboard (storylets, choices) {\r\n    let levelsSTMap = createLevelSTMap(storylets, choices)\r\n    let stxy = setStoryletXY(levelsSTMap, true)\r\n\r\n    return stxy\r\n}   \r\n\r\n/**\r\n * Create a Level Map, to help paint Storylet Boxes on screen\r\n * {\r\n *      1: [stID1, stID9],\r\n *      2: [stID3, stID5, stID7, stID11]\r\n *      3: [stID23, stID77, stID89, stID99, stID100]\r\n * }\r\n */\r\nfunction createLevelSTMap (storylets, choices) {\r\n    let levelsSTMap = {}\r\n\r\n    // get the Entry Storylets\r\n    // This entry-storylets each will start a new tree\r\n    // and then following next of each one we can draw their trees\r\n    let allStIDs = Object.keys(storylets)\r\n    let entryStIDs = getEntryStIDs(allStIDs, choices)\r\n\r\n    // Let's declare a helper function to put Storylets into Levels, recurssively\r\n    const putStIntoLevels = (st, level) => {\r\n        levelsSTMap[level] = levelsSTMap[level] || []\r\n        levelsSTMap[level].push(st.id)\r\n\r\n        for (let cid of st.choices) {\r\n            let c = choices[cid]\r\n            putStIntoLevels(storylets[c.next], level + 1)\r\n        }\r\n    }\r\n\r\n    // Now go thru each entry points and seek out their tree\r\n    // and put them in levelMaps\r\n    for (let id of entryStIDs) {\r\n        //Increase level by 1\r\n        let currentLevel = Object.keys(levelsSTMap).length + 1\r\n\r\n        putStIntoLevels(storylets[id], currentLevel)\r\n    }\r\n\r\n    // Now there can be cases where 2 different levels are containing same IDs\r\n    // In these case we will keep them only in the highest level\r\n    let alreadyFoundStIDs = []\r\n    let levelsDecending = Object.keys(levelsSTMap).sort().reverse()\r\n\r\n    for (let l of levelsDecending) {\r\n        //cleanup duplicate in each level\r\n        levelsSTMap[l] = Array.from(new Set(levelsSTMap[l]))\r\n\r\n        // go thru each stIDs of this level\r\n        // if it was already found in higher levels, delete it from this level\r\n        // else mark it as found\r\n        for (let stID of levelsSTMap[l]) {\r\n            if (alreadyFoundStIDs.indexOf(stID) > -1) {\r\n                levelsSTMap[l].splice(levelsSTMap[l].indexOf(stID), 1)\r\n            }\r\n            else {\r\n                alreadyFoundStIDs.push(stID)\r\n            }\r\n        }\r\n    }\r\n\r\n    return levelsSTMap\r\n}\r\n\r\n// Storylets are Not pointed by any choice\r\n// returns array of STIDs\r\nfunction getEntryStIDs(allStIDs, choices) {\r\n    let entryStIDs = [...allStIDs]\r\n    // now loop thru all the choices\r\n    // remove the choice.next IDs from allStIDs\r\n    // the rests are EntrySTID\r\n    for (let i in choices) {\r\n        let idx = entryStIDs.indexOf(choices[i].next)\r\n        if (idx > -1) {\r\n            entryStIDs.splice(idx, 1)\r\n        }\r\n    }\r\n\r\n    return entryStIDs\r\n}\r\n\r\n/*\r\n* Set X, Y for the storylets VERSION 2\r\n* This v2 function will try position them better\r\n* with proper middle alignments for the row which have lesser number of rectangles\r\n*/\r\nfunction setStoryletXY (levelsSTMap, isAutoFormatting) {\r\n    //go level by level\r\n    let level = 0\r\n    const stWidth = FLOW_ST_WIDTH\r\n    const stHeight = FLOW_ST_HEIGHT\r\n    const horizontalGap = FLOW_H_GAP\r\n    const verticalGap = FLOW_V_GAP\r\n    const verticalShift = FLOW_V_SHIFT\r\n    const horizontalShift = FLOW_H_SHIFT\r\n    const stxy = {}              // { id1: {x1,y1}, id2: {x2,y2} }\r\n\r\n    let maxRecInALevel = Object.values(levelsSTMap).reduce(\r\n        (maxLength, l) => maxLength > l.length ? maxLength : l.length\r\n    , 0)\r\n\r\n    //first we need to find the longest possible row\r\n    // for (let i in levelsSTMap) {\r\n    //     maxRecInALevel = (levelsSTMap[i].length > maxRecInALevel) ? levelsSTMap[i].length : maxRecInALevel\r\n    // }\r\n\r\n    const longestRowWidth = (maxRecInALevel * stWidth) + (horizontalGap * (maxRecInALevel - 1));\r\n\r\n    while (true) {\r\n        ++level\r\n        //since there cannot be a jump in level\r\n        //if any number is missing, that means there are\r\n        //no more higher levels\r\n        if (!levelsSTMap[level]) {\r\n            break;\r\n        }\r\n\r\n        let recsInThisLevel = levelsSTMap[level].length;\r\n\r\n        // if less than max, then \r\n        // 1st rec of that row (or level) will have a spacing at its left\r\n        // And last rec will have a spacing at its right\r\n        // so total spacing will be recsInThisLevel+1\r\n        if (recsInThisLevel < maxRecInALevel) {\r\n            let hGap = (longestRowWidth - (recsInThisLevel * stWidth)) / (recsInThisLevel + 1);\r\n            for (let i = 0; i < levelsSTMap[level].length; i++) {\r\n                let stID = levelsSTMap[level][i]\r\n                stxy[stID] = { id: stID }\r\n\r\n                // if autoformatting, then override the x, y values set by user dragging\r\n                if (!isAutoFormatting && stxy[stID].x && stxy[stID].y) { continue; }\r\n                stxy[stID].x = (i * stWidth) + ((i + 1) * hGap) + horizontalShift\r\n                stxy[stID].y = (level - 1) * (stHeight + verticalGap) + verticalShift\r\n                //setTransformStyle(stID)\r\n            }\r\n        }\r\n        // else for the longest row, there will be no gap with on left of 1st or right of last\r\n        else {\r\n            for (let i = 0; i < levelsSTMap[level].length; i++) {\r\n                let stID = levelsSTMap[level][i]\r\n                stxy[stID] = { id: stID }\r\n\r\n                if (!isAutoFormatting && stxy[stID].x && stxy[stID].y) { continue; }\r\n                stxy[stID].x = (i * stWidth) + (i * horizontalGap) + horizontalShift;\r\n                stxy[stID].y = (level - 1) * (stHeight + verticalGap) + verticalShift;\r\n                //setTransformStyle(stID);\r\n            }\r\n        }\r\n    }\r\n\r\n    setTransformStyle(stxy)\r\n\r\n    //this.flowboard = objToArray(this.stObj);\r\n    // console.log(\"this.storylets = \");\r\n    // console.log(this.storylets);\r\n    \r\n    //this.recreateConnectorsObj();\r\n    return stxy\r\n}\r\n\r\n// provided it has x,y\r\n// this function sets the transformStyle\r\nfunction setTransformStyle(stxy) {\r\n    for (let i in stxy) {\r\n        stxy[i].transformStyle =  getTransformStyle(stxy[i])\r\n    }\r\n}\r\n\r\n// fbi = Flowboard Item\r\nfunction getTransformStyle (fbi) {\r\n    return { transform: \"matrix(1, 0, 0, 1, \" + fbi.x + \", \" + fbi.y + \")\" }\r\n}\r\n\r\n/**\r\n * \r\n * @param {*} storylets \r\n * @param {*} choices \r\n * @param {*} fb => flowboard, a json onject containing stID, x,y, transformStyle\r\n */\r\nfunction createFlowConnectors (storylets, choices, fb) {\r\n    const connectorsObj = {}\r\n    const wireShiftFTX = FLOW_WIRE_SHIFT_X\r\n\tconst wireShiftFY = FLOW_WIRE_SHIFT_FROM_Y\r\n    const wireShiftTY = FLOW_WIRE_SHIFT_TO_Y\r\n\r\n    for(let i in storylets) {\r\n        let st = storylets[i]\r\n        for(let cID of st.choices) {\r\n            let ch = choices[cID]\r\n\r\n            let fromX = fb[st.id].x + wireShiftFTX\r\n            let fromY = fb[st.id].y + wireShiftFY\r\n            let toX = fb[ch.next].x + wireShiftFTX\r\n            let toY = fb[ch.next].y + wireShiftTY\r\n\r\n            let ftid = st.id + '---' + ch.next\r\n\r\n            connectorsObj[ftid] = {\r\n                id: ftid,\r\n                cid: cID,\r\n                x1: fromX,\r\n                y1: fromY,\r\n                x2: toX,\r\n                y2: toY\r\n            }\r\n        }\r\n    }\r\n\r\n    return connectorsObj\r\n}","import React, { useState, useEffect, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Box from '@material-ui/core/Box'\r\nimport _ from 'lodash'\r\nimport { connect } from 'react-redux'\r\nimport { startsWith } from '../../../utils/util'\r\nimport ControlPanel from './controlPanel/ControlPanel'\r\nimport JoyStick from './controlPanel/JoyStick'\r\nimport FlowST from './FlowST'\r\nimport FlowConnector from './FlowConnector'\r\nimport ModalEditChoice from './ModalEditChoice'\r\nimport FullScreenEdit from '../../common/modal/FullScreenEdit'\r\nimport { createFlowboard, getTransformStyle, createFlowConnectors } from './flowMaker'\r\nimport {\r\n    actionCreateNewTale,\r\n    actionCreateChoice,\r\n    actionUpdateCText\r\n} from '../../../redux/actionCreators/createTaleActions'\r\nimport {\r\n    FLOW_WIRE_SHIFT_X,\r\n    FLOW_WIRE_SHIFT_FROM_Y,\r\n    FLOW_WIRE_SHIFT_TO_Y,\r\n    FLOW_SPEED\r\n} from '../../../utils/constants'\r\nimport {\r\n    STORYLET_DELETE,\r\n    CHOICE_DELETE\r\n} from '../../../redux/actionTypes'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    outerContainer: {\r\n        position: 'relative',\r\n        marginLeft: 35,\r\n        paddingTop: 7,\r\n        height: \"calc(100vh - 100px)\"\r\n    },\r\n    svgContainer: {\r\n        border: `7px double ${theme.palette.primary.main}`,\r\n        height: \"100%\",\r\n        overflow: \"auto\",\r\n        borderRadius: theme.spacing(1)\r\n    },\r\n    mainSVG: {\r\n        height: 2000,\r\n        minWidth: \"100%\",\r\n        width: 2000,\r\n        \"-webkit-user-select\": \"none\",  /* Chrome all / Safari all */\r\n        \"-moz-user-select\": \"none\",     /* Firefox all */\r\n        \"-ms-user-select\": \"none\",      /* IE 10+ */\r\n        userSelect: \"none\",\r\n        borderRadius: 15,\r\n        \"& *\": {\r\n            \"-webkit-user-select\": \"none\",  /* Chrome all / Safari all */\r\n            \"-moz-user-select\": \"none\",     /* Firefox all */\r\n            \"-ms-user-select\": \"none\",      /* IE 10+ */\r\n            userSelect: \"none\"\r\n        }\r\n    },\r\n    joystick: {\r\n        position: \"absolute\",\r\n        bottom: 83,\r\n        left: 30\r\n    }\r\n}))\r\n\r\nconst TalesFlow = props => {\r\n    const classes = useStyles()\r\n    const { storylets, choices, start, history, createNewTale, deleteStorylet, deleteChoice, createNewChoice, updateChoiceText } = props\r\n    const [fb, setFb] = useState({})    // fb is flowboard object\r\n    const [fbC, setFbC] = useState({})  // fbC is flowboardConnectors object\r\n    const [isJStickVis, setJStickVis] = useState(false)\r\n    const [draggedStID, setDraggedStID] = useState('')\r\n    const [prevMPos, setPrevMPos] = useState({ x: 0, y: 0 })\r\n    const [selectedObj, setSelectedObj] = useState({id: '', type: ''})  // type will be \"ST\" or \"CH\" or \"IN\" or \"OUT\"\r\n    const [editChoiceData, setEditChoiceData] = useState({})\r\n    const [fseParam, setFSEParam] = useState({})    // Full Screen Edit    \r\n    const closeFSE = () => setFSEParam({})\r\n    // component is either a St or a Ch object\r\n    const openFSE = () => {\r\n        //console.log(component)\r\n        let component\r\n\r\n        if (!selectedObj.id || selectedObj.type==='IN' || selectedObj.type==='OUT') {\r\n            alert('Select a storylet or choice (connector) first. Then click on delete.')\r\n            return\r\n        }\r\n        else if(selectedObj.id[0] === 'S') component = storylets[selectedObj.id]\r\n        else if(selectedObj.id[0] === 'C') component = choices[selectedObj.id]\r\n\r\n        setFSEParam({\r\n            component, isVisible: true\r\n        })\r\n    }\r\n    /**\r\n     * flowBoard: {\r\n     *      stID1: {\r\n     *                  id: stID1,\r\n     *                  x: value,\r\n     *                  y: value,\r\n     *                  transformStyle: someCSSTransformStyle\r\n     *             },\r\n     *      stID2: {\r\n     *                  id: stID2,\r\n     *                  x: value,\r\n     *                  y: value,\r\n     *                  transformStyle: someCSSTransformStyle\r\n     *              }\r\n     * }\r\n     */\r\n    const paintFlowboard = useCallback(() => {\r\n        let flowBoard = createFlowboard(storylets, choices)\r\n        let flowConnectors = createFlowConnectors(storylets, choices, flowBoard)\r\n        // console.log(\"Inside paintFlowboard ............................. flowBoard = \", flowBoard)\r\n        setFb(flowBoard)\r\n        setFbC(flowConnectors)\r\n    }, [storylets, choices])\r\n\r\n    useEffect(() => {\r\n        //if a refresh is done on TalesFlow Page\r\n        // Then start creation process from here\r\n        if(!start) {\r\n            createNewTale()\r\n        }\r\n\r\n        paintFlowboard ()\r\n        \r\n    }, [createNewTale, start, paintFlowboard])\r\n\r\n    const handleSelection = (id, type) => {\r\n        // if prev selectedObj was 'out'\r\n        // and this is 'IN'\r\n        // Then create a choice (connection)\r\n        if (selectedObj.type === 'OUT' && type=== 'IN') {\r\n            let fromStID = selectedObj.id\r\n            let toStID = id\r\n            let ftid = fromStID + '---' + toStID\r\n\r\n            setEditChoiceData({\r\n                isOpen: true,\r\n                fromStID: fromStID,\r\n                toStID: toStID,\r\n                type: fbC[ftid] ? 'Edit' : 'Create',\r\n                text: fbC[ftid] ? choices[fbC[ftid].cid].text : ''\r\n            })\r\n            // if (fbC[ftid]) {\r\n            //     console.log('Connection already exists...')\r\n            // } else {\r\n            //     console.log(`Create connector from ${selectedObj.id} to ${id}`)\r\n            // }\r\n        }\r\n\r\n        // Now update the state\r\n        setSelectedObj({id, type})\r\n    }\r\n\r\n    const saveEditCreateChoice = (fromStID, toStID, text, type) => {\r\n        // is it create new\r\n        if (type === 'Create') {\r\n            createNewChoice(fromStID, toStID, text)\r\n        }\r\n        else if (type === 'Edit') {\r\n            let ftid = fromStID + '---' + toStID\r\n            let cID = fbC[ftid].cid\r\n            updateChoiceText(cID, text)\r\n        }\r\n        else {\r\n            console.log('Could not understand the type in saveEditCreateChoice')\r\n        }\r\n\r\n        setEditChoiceData({})\r\n    }\r\n\r\n    /**\r\n     * Whenever an ST is dragged/moved, we need to update the associated connectors\r\n     * @param {*} fbi => the updated flowboard item\r\n     */\r\n    const updateConnectors = fbi => {\r\n        let newFBC = {...fbC}\r\n        let wireShiftFTX = FLOW_WIRE_SHIFT_X\r\n        let wireShiftFY = FLOW_WIRE_SHIFT_FROM_Y\r\n        let wireShiftTY = FLOW_WIRE_SHIFT_TO_Y\r\n        // Go thru all the flowboard-Connectors\r\n        // to see with whom this stID is connected\r\n        for(let i in newFBC) {\r\n            let c = newFBC[i]\r\n            let ftidParts = c.id.split('---')   // id is basically ftid\r\n            let fromStID = ftidParts[0]\r\n            let toStID = ftidParts[1]\r\n\r\n            // if from id is this ST\r\n            if (fbi.id === fromStID) {\r\n                c = {...c}\r\n                c.x1 = fbi.x + wireShiftFTX\r\n                c.y1 = fbi.y + wireShiftFY\r\n\r\n                newFBC = {\r\n                    ...newFBC,\r\n                    [c.id]: c\r\n                }\r\n            }\r\n            // elseif to id is this ST\r\n            else if (fbi.id === toStID) {\r\n                c = {...c}\r\n                c.x2 = fbi.x + wireShiftFTX\r\n                c.y2 = fbi.y + wireShiftTY\r\n\r\n                newFBC = {\r\n                    ...newFBC,\r\n                    [c.id]: c\r\n                }\r\n            }\r\n        }\r\n\r\n        setFbC(newFBC)\r\n    }\r\n    \r\n    const markDraggedStID = (ev, stID) => {\r\n        ev.stopPropagation()\r\n        // console.log('setDraggedStID')\r\n        setDraggedStID(stID)\r\n        setPrevMPos({ x: ev.pageX,  y: ev.pageY })\r\n    }\r\n\r\n    const unmarkDraggedStID = ev => {\r\n        ev.stopPropagation()\r\n        // console.log('unsetDraggedStID')\r\n        setDraggedStID('')\r\n        setPrevMPos({ x: 0,  y: 0 })\r\n    }\r\n\r\n    const moveST = (stID, xDisplace, yDisplace) => {\r\n        if (!stID || !fb[stID]) return   // Important, don't remove\r\n        let prevElX = fb[stID].x\r\n        let prevElY = fb[stID].y\r\n        let newFBI = {\r\n            id: stID,\r\n            x: prevElX + xDisplace,\r\n            y: prevElY + yDisplace\r\n        }\r\n        newFBI.transformStyle = getTransformStyle(newFBI)\r\n        let newFB = {\r\n            ...fb,\r\n            [stID]: newFBI\r\n        }\r\n        setFb(newFB)\r\n\r\n        //ALSO NEED TO UPDATE THE CONNECTORS POSITION\r\n        updateConnectors(newFBI)\r\n    }\r\n\r\n    const moveDraggetST = _.throttle(ev => {\r\n        //ev.stopPropagation()\r\n        // console.log(\"moving 1\")\r\n        if (draggedStID) {\r\n            // console.log(\"moving 2\")\r\n            let mouseDiffX = ev.pageX - prevMPos.x\r\n            let mouseDiffY = ev.pageY - prevMPos.y\r\n            moveST(draggedStID, mouseDiffX, mouseDiffY)\r\n            setPrevMPos({ x: ev.pageX,  y: ev.pageY })\r\n        }\r\n    }, 1000)\r\n\r\n    const moveWithJStick = (xDisplace, yDisplace) => {\r\n        if (selectedObj.type === 'ST') {\r\n            moveST(selectedObj.id, xDisplace, yDisplace)\r\n        }\r\n    }\r\n\r\n    const moveLeft = () => moveWithJStick(-FLOW_SPEED, 0)\r\n    const moveRight = () => moveWithJStick(FLOW_SPEED, 0)\r\n    const moveUp = () => moveWithJStick(0, -FLOW_SPEED)\r\n    const moveDown = () => moveWithJStick(0, FLOW_SPEED)\r\n\r\n    const deleteComponent = () => {\r\n        if (!selectedObj.id || selectedObj.type==='IN' || selectedObj.type==='OUT') {\r\n            alert('Select a storylet or choice (connector) first. Then click on delete.')\r\n        }\r\n        else if(selectedObj.id === start) {\r\n            alert('Start storylet can not be deleted. Please edit it to your choice.')\r\n        }\r\n        else {\r\n            let comName = ''\r\n            if(selectedObj.id[0] === 'S') comName = 'STORYLET'\r\n            else if(selectedObj.id[0] === 'C') comName = 'CHOICE'\r\n\r\n            let r = window.confirm(`Are you sure you want to delete ${comName} ${selectedObj.id}. Once deleted, it may not be recovered back.`)\r\n\r\n            if (r) {\r\n                if(comName === 'STORYLET') deleteStorylet(selectedObj.id)\r\n                else if (comName === 'CHOICE') deleteChoice(selectedObj.id)\r\n            }\r\n        }\r\n    }\r\n\r\n    // If props have changed, but useEffect has not updated flowboard yet\r\n    // stop the rendering\r\n    if (\r\n            Object.keys(storylets).length !== Object.keys(fb).length\r\n            ||\r\n            Object.keys(choices).length !== Object.keys(fbC).length\r\n        ) {\r\n        return (\r\n            <Box>\r\n                {/* {console.log('Stopping early rendering...')} */}\r\n                Updating ...\r\n            </Box>\r\n        )\r\n    }\r\n\r\n    // Else return\r\n    return (\r\n        <Box>\r\n            <ControlPanel \r\n                history={history} \r\n                deleteComponent={deleteComponent} \r\n                paintFlowboard={paintFlowboard}\r\n                toggleJStick={() => setJStickVis(!isJStickVis)}\r\n                openFSE={openFSE}\r\n            />\r\n\r\n            <div className={classes.outerContainer}>\r\n                <div className={classes.svgContainer} onClick={() => setSelectedObj({})}>\r\n                    <svg \r\n                        className={classes.mainSVG} \r\n                        onMouseUp={e => unmarkDraggedStID(e)}\r\n                    >\r\n                        {\r\n                            Object.values(fbC).map(c => \r\n                                <FlowConnector \r\n                                    c={c} key={c.id} \r\n                                    selectedObj={selectedObj}\r\n                                    handleSelection={handleSelection}\r\n                                />\r\n                            )\r\n                        }\r\n                        \r\n                        {\r\n                            //console.log(\"props.storylets\", storylets)\r\n                            Object.values(fb).map(fbi => {\r\n                                let st = storylets[fbi.id]\r\n                                return (<FlowST \r\n                                            stid={st.id} \r\n                                            title={st.title} \r\n                                            transformStyle={fbi.transformStyle}\r\n                                            start={start} \r\n                                            key={st.id}\r\n                                            selectedObj={selectedObj}\r\n                                            handleSelection={handleSelection}\r\n                                            handleMouseDown={markDraggedStID}\r\n                                            handleMouseUp={unmarkDraggedStID}\r\n                                            handleMouseMove={moveDraggetST}\r\n                                        />)\r\n                            })\r\n                        }\r\n                    </svg>\r\n                </div>\r\n\r\n                <div className={clsx(classes.joystick, !isJStickVis && 'hide')}>\r\n                    <JoyStick \r\n                        moveLeft={moveLeft}\r\n                        moveRight={moveRight}\r\n                        moveUp={moveUp}\r\n                        moveDown={moveDown}\r\n                    />\r\n                </div>\r\n            </div>\r\n        \r\n            <ModalEditChoice \r\n                isOpen={editChoiceData.isOpen} \r\n                {...editChoiceData}\r\n                handleClose={()=>setEditChoiceData({})}\r\n                handleSave={saveEditCreateChoice}\r\n            />\r\n\r\n            <FullScreenEdit \r\n                isOpen={fseParam.isVisible}\r\n                handleClose={closeFSE}\r\n                component={fseParam.component}\r\n            />\r\n        </Box>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    start: state.wipTale.start,\r\n    storylets: state.wipTale.storylets,\r\n    choices: state.wipTale.choices\r\n})\r\nconst mapDispatchToProps = dispatch => ({\r\n    createNewTale: () => dispatch(actionCreateNewTale()),\r\n    deleteStorylet: stID => dispatch({type: STORYLET_DELETE, payload: stID}),\r\n    deleteChoice: cID => dispatch({type: CHOICE_DELETE, payload: cID}),\r\n    createNewChoice: (fromStID, toStID, text) => dispatch(actionCreateChoice(fromStID, toStID, text)),\r\n    updateChoiceText: (cID, value) => dispatch(actionUpdateCText(cID, value))\r\n})\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TalesFlow)","import React, { useState, useEffect } from 'react'\r\n// import { makeStyles } from '@material-ui/core/styles'\r\n// import Paper from '@material-ui/core/Paper'\r\nimport Box from '@material-ui/core/Box'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport ComplexCard from '../../common/cards/ComplexCard'\r\nimport { LOCAL_TALE_IDENTIFIER } from '../../../utils/constants'\r\n\r\n// const useStyles = makeStyles(theme => ({\r\n//     cardsContainer: {\r\n\r\n//     }\r\n// }))\r\n\r\nconst MyLocalTales = props => {\r\n    // const classes = useStyles()\r\n    const [localTales, setLocalTales] = useState([])\r\n    const {history} = props\r\n    \r\n    const localLocalTales = () => {\r\n        const allReactales = JSON.parse(window.localStorage.getItem(\"allReactales\")) || {}\r\n        setLocalTales(Object.values(allReactales))\r\n    }\r\n\r\n    const goToTale = id => history.push(`/preview/${LOCAL_TALE_IDENTIFIER}${id}`)\r\n    \r\n    useEffect(() => {\r\n        localLocalTales()\r\n    }, [])\r\n\r\n    const goToEditTale = id => {\r\n        props.history.push(`/edit-tale/${LOCAL_TALE_IDENTIFIER}${id}`)\r\n    }\r\n\r\n    const deleteTale = id => {\r\n        let r = window.confirm('Are you sure you want to delete this local tale. It can not be recovered later (unless you have exported it and import it later)')\r\n        if (!r) return\r\n        let allReactales = JSON.parse(window.localStorage.getItem(\"allReactales\"))\r\n        delete allReactales[id]\r\n        window.localStorage.setItem(\"allReactales\", JSON.stringify(allReactales))\r\n        setLocalTales(Object.values(allReactales))\r\n        alert('Local tale deleted successfully')\r\n    }\r\n\r\n    return (\r\n        <Box py={3}>\r\n            <Grid container spacing={2}>\r\n                {\r\n                    localTales.map (t => (\r\n                        <Grid item xs={12} sm={6} md={4} lg={3} xl={2} key={t.id}>\r\n                            <ComplexCard \r\n                                id={t.id}\r\n                                info={t.info} \r\n                                expandable={false} \r\n                                handleReadTale={() => goToTale(t.id)}\r\n                                handleEdit={goToEditTale}\r\n                                handleDelete={deleteTale}  />\r\n                        </Grid>\r\n                    ))\r\n                }\r\n            </Grid>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default MyLocalTales","import { \r\n    Home, \r\n    CreateTale, \r\n    TalesFlow, \r\n    MyTales, \r\n    PreviewTale \r\n} from '../components/pages'\r\n\r\nconst routes = [\r\n    {\r\n        path: \"/home\",\r\n        component: Home,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/create-tale\",\r\n        component: CreateTale,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/preview/:id\",\r\n        component: PreviewTale,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/edit-tale/:id\",\r\n        component: CreateTale,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/tales-flow\",\r\n        component: TalesFlow,\r\n        exact: true\r\n    },\r\n    {\r\n        path: \"/my-tales\",\r\n        component: MyTales,\r\n        exact: true\r\n    }\r\n]\r\n\r\nexport default routes","import React, { useState, useEffect, useCallback } from 'react'\r\n// import { makeStyles } from '@material-ui/core/styles'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { LOCAL_TALE_IDENTIFIER } from '../../../utils/constants'\r\nimport { URL_GET_STORY } from \"../../../utils/urls\";\r\nimport axios from 'axios'\r\n\r\nconst PreviewTale = props => {\r\n    const [tale, setTale] = useState(null)\r\n    const [sb, setSB] = useState([])    // sb = Storyboard, sbI[], sbI = { stID, selectedCID }\r\n    const { match } = props\r\n    const goTo = url => props.history.push(url)\r\n    \r\n    useEffect(() => {\r\n        let storyUrl = match.params.id\r\n        // If it is a local story\r\n        // Then the ID should start with \"local\"\r\n        if (storyUrl.indexOf(LOCAL_TALE_IDENTIFIER) >= 0) {\r\n            storyUrl = storyUrl.trim().replace(LOCAL_TALE_IDENTIFIER, \"\")\r\n            const allReactales = JSON.parse(window.localStorage.getItem(\"allReactales\")) || {}\r\n            const theTale = allReactales[storyUrl]\r\n            console.log(theTale)\r\n            setTale(theTale)\r\n            // setSB([{ stID: theTale.id }])\r\n            window.rto.createTimeline('timelineContainer', theTale)\r\n        }\r\n\r\n        // Else fetch it online\r\n        else {\r\n            axios.post(URL_GET_STORY, {storyUrl})\r\n            .then(res => {\r\n                // console.log(res.data)\r\n                let {status, tale} = res.data\r\n                if(status === 200) {\r\n                    tale = JSON.parse(tale)\r\n                    console.log(tale)\r\n                    setTale(tale)\r\n                    window.rto.createTimeline('timelineContainer', tale)\r\n                }\r\n                else {\r\n                    console.log(\"most probably some error occurred\")\r\n                }\r\n            })\r\n            .catch(err =>{\r\n                console.log(err)\r\n            })\r\n        }\r\n    },\r\n    [])\r\n\r\n    return (\r\n        <Box py={2} mb={5}>\r\n            {   \r\n                tale &&\r\n                <Typography variant=\"h4\" component=\"h1\">\r\n                    {tale.info.name}\r\n                </Typography>\r\n            }\r\n\r\n            <div id=\"timelineContainer\"></div>\r\n        \r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default PreviewTale","import React, { useState } from 'react'\r\n// import { makeStyles } from '@material-ui/core/styles'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\n// import Button from '@material-ui/core/Button'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { connect } from 'react-redux'\r\nimport MyLocalTales from './MyLocalTales'\r\n// import {\r\n//     actionCreateNewTale,\r\n//     actionSaveTaleAndReset\r\n// } from '../../../redux/actionCreators/createTaleActions'\r\n\r\n\r\nconst MyTales = props => {\r\n    const [visibleTabIndex, setVisibleTab] = useState(0)\r\n    \r\n    const handleTabSwitch = (event, newValue) => {\r\n        setVisibleTab(newValue)\r\n    }\r\n\r\n    return (\r\n        <Box p={2}>\r\n            \r\n            <Typography variant=\"h4\" component=\"h1\">\r\n                My Tales\r\n            </Typography>\r\n            \r\n            <Box mt={2} mb={4} className=\"flex-space-between\">\r\n                <Typography variant=\"subtitle1\">\r\n                    Here you will find all the tales created by you\r\n                </Typography>\r\n            </Box>\r\n\r\n            <Paper square>\r\n                <Tabs\r\n                    value={visibleTabIndex}\r\n                    indicatorColor=\"primary\"\r\n                    textColor=\"primary\"\r\n                    onChange={handleTabSwitch}\r\n                    centered\r\n                    aria-label=\"tabs to create the story\"\r\n                >\r\n                    <Tab label=\"Local\" />\r\n                    <Tab label=\"Online\" />\r\n                </Tabs>\r\n            </Paper>\r\n            \r\n            <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                <MyLocalTales history={props.history}/>\r\n            </Box>\r\n\r\n            <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                \r\n            </Box>\r\n        </Box>\r\n    )\r\n}\r\n\r\nexport default connect()(MyTales)","import React, { useState, useEffect } from 'react'\r\nimport SimpleModal from '../../common/modal/SimpleModal'\r\nimport Typography from '@material-ui/core/Typography';\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Button from '@material-ui/core/Button'\r\nimport { connect } from 'react-redux'\r\nimport {\r\n    UI_LOGIN_MODAL_CLOSE, \r\n    UI_LOGIN_SET_ACT_TAB\r\n} from '../../../redux/actionTypes'\r\nimport {\r\n    actionLogin,\r\n    actionSignup\r\n} from '../../../redux/actionCreators/userActions'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    menuButton: {\r\n      marginRight: theme.spacing(2),\r\n    },\r\n    loginModal: {\r\n        maxWidth: 600,\r\n        padding: 0\r\n    }\r\n}))\r\n\r\nconst LoginModal = props => {\r\n    const classes = useStyles()\r\n    const {isOpen, handleClose, visibleTabIndex, title, changeTab, user, doLogin, doSignup} = props\r\n    const handleTabSwitch = (e, tabIndex) => changeTab(tabIndex)\r\n    const [localUser, setLocalUser] = useState(user || {})\r\n\r\n    useEffect(() => {\r\n        console.log(\"Inside useEffect, user changed\")\r\n        if(user) {\r\n            setLocalUser(user)\r\n        }\r\n    }, [user])\r\n\r\n    const handleLogin = () => {\r\n        const { email, pswd } = localUser\r\n        if (!email || !pswd) {\r\n            alert('Enter Email and Password to login...')\r\n            return\r\n        }\r\n        doLogin({ email, pswd })\r\n    }\r\n\r\n    const handleSignup = () => {\r\n        const { email, pswd, firstname, lastname } = localUser\r\n        if (!email || !pswd || !firstname || !lastname) {\r\n            alert('Enter Firstname, Lastname Email, Password to login...')\r\n            return\r\n        }\r\n        doSignup({ email, pswd, firstname, lastname })\r\n    }\r\n\r\n    const updateLocalUser = e => {\r\n        setLocalUser({\r\n            ...localUser,\r\n            [e.target.name]: e.target.value\r\n        })\r\n    }\r\n\r\n    return (\r\n        <SimpleModal \r\n            isOpen={isOpen} \r\n            handleClose = {handleClose}\r\n            title={title || \"Hi There!\"}\r\n            className={classes.loginModal}\r\n        >\r\n            <Paper square>\r\n                <Tabs\r\n                    value={visibleTabIndex}\r\n                    indicatorColor=\"primary\"\r\n                    textColor=\"primary\"\r\n                    onChange={handleTabSwitch}\r\n                    centered\r\n                    aria-label=\"tabs to create the story\"\r\n                >\r\n                    <Tab label=\"Sign in\" />\r\n                    <Tab label=\"Sign up\" />\r\n                    {/* <Tab label=\"Recovery\" /> */}\r\n                </Tabs>\r\n            </Paper>\r\n            \r\n            {/* Sign In Section */}\r\n            <Box className={visibleTabIndex !== 0 ? 'hide' : ''}>\r\n                <TextField label=\"Email\" name=\"email\" value={localUser.email} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"margin-top-25\" />\r\n                <TextField label=\"Password\" name=\"pswd\" value={localUser.pswd} onChange={updateLocalUser} type=\"password\" variant=\"outlined\" size=\"small\" fullWidth className=\"margin-top-25\" />\r\n                <Button \r\n                    variant=\"outlined\" \r\n                    color=\"primary\"\r\n                    className=\"margin-top-25\"\r\n                    fullWidth\r\n                    onClick={handleLogin}\r\n                >\r\n                    Sign in\r\n                </Button>\r\n            </Box>\r\n\r\n            {/* Sign Up Section */}\r\n            <Box className={visibleTabIndex !== 1 ? 'hide' : ''}>\r\n                <TextField label=\"First name\" name=\"firstname\" value={localUser.firstname} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"margin-top-25\" />\r\n                <TextField label=\"Last name\" name=\"lastname\" value={localUser.lastname} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"margin-top-25\" />\r\n                <TextField label=\"Email\" name=\"email\" value={localUser.email} onChange={updateLocalUser} variant=\"outlined\" size=\"small\" fullWidth className=\"margin-top-25\" />\r\n                <TextField label=\"Password\" name=\"pswd\" value={localUser.pswd} onChange={updateLocalUser} type=\"password\" variant=\"outlined\" size=\"small\" fullWidth className=\"margin-top-25\" />\r\n                <Button \r\n                    variant=\"outlined\" \r\n                    color=\"primary\"\r\n                    className=\"margin-top-25\"\r\n                    fullWidth\r\n                    onClick={handleSignup}\r\n                >\r\n                    Sign up\r\n                </Button>\r\n            </Box>\r\n\r\n            {/* Password Recovery Section */}\r\n            {/* <Box className={visibleTabIndex !== 2 ? 'hide' : ''}>\r\n                Recovery\r\n            </Box> */}\r\n            \r\n\r\n            {/* <Box align=\"center\" my={1}>\r\n                <Typography variant=\"h6\" gutterBottom>\r\n                    <b>OR</b>\r\n                </Typography>\r\n            </Box> */}\r\n\r\n            \r\n        </SimpleModal>\r\n    )\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n    isOpen: state.ui.isLoginModalOpen,\r\n    visibleTabIndex: state.ui.loginActiveTab,\r\n    user: state.user\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    handleClose: () => dispatch({type: UI_LOGIN_MODAL_CLOSE}),\r\n    changeTab: tabIndex => dispatch({type: UI_LOGIN_SET_ACT_TAB, payload: {tabIndex}}),\r\n    doLogin: u => dispatch(actionLogin(u)),\r\n    doSignup: u => dispatch(actionSignup(u))\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LoginModal)","import React from 'react'\nimport { ThemeProvider } from '@material-ui/core/styles'\nimport Container from '@material-ui/core/Container'\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\nimport { Provider } from 'react-redux'\nimport store from './redux/configStore'\nimport theme from './utils/theme'\nimport './App.css';\nimport { Header, Sidebard, Footer } from './components/layout'\nimport routes from './utils/routes'\nimport LoginModal from './components/common/login/LoginModal'\n\nconst App = () => {\n  return (\n    <ThemeProvider theme={theme}>\n      <Provider store={store}>\n        <Router>\n          <header>\n            <Header />\n          </header>\n          <nav>\n            <Sidebard />\n          </nav>\n          <LoginModal />\n          <Container maxWidth=\"xl\" className=\"appbody\">\n            <Switch>\n              {\n                routes.map(r =>\n                  <Route {...r} key={r.path} />\n                )\n              }\n              <Route path=\"*\">\n                <Redirect to=\"/\" />\n              </Route>\n            </Switch>\n          </Container>\n          <footer>\n            <Footer />\n          </footer>\n        </Router>\n      </Provider>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"logoContainer\":\"style_logoContainer__SjjSp\",\"logoImg\":\"style_logoImg__1Xgbm\"};"],"sourceRoot":""}